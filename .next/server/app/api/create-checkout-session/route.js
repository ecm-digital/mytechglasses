"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/create-checkout-session/route";
exports.ids = ["app/api/create-checkout-session/route"];
exports.modules = {

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "child_process":
/*!********************************!*\
  !*** external "child_process" ***!
  \********************************/
/***/ ((module) => {

module.exports = require("child_process");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "events":
/*!*************************!*\
  !*** external "events" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("events");

/***/ }),

/***/ "http":
/*!***********************!*\
  !*** external "http" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("http");

/***/ }),

/***/ "https":
/*!************************!*\
  !*** external "https" ***!
  \************************/
/***/ ((module) => {

module.exports = require("https");

/***/ }),

/***/ "util":
/*!***********************!*\
  !*** external "util" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("util");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcreate-checkout-session%2Froute&page=%2Fapi%2Fcreate-checkout-session%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcreate-checkout-session%2Froute.ts&appDir=%2FUsers%2Ftomaszgt%2FMytechglasses%2Fmy-tech-glasses%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftomaszgt%2FMytechglasses%2Fmy-tech-glasses&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcreate-checkout-session%2Froute&page=%2Fapi%2Fcreate-checkout-session%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcreate-checkout-session%2Froute.ts&appDir=%2FUsers%2Ftomaszgt%2FMytechglasses%2Fmy-tech-glasses%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftomaszgt%2FMytechglasses%2Fmy-tech-glasses&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _Users_tomaszgt_Mytechglasses_my_tech_glasses_src_app_api_create_checkout_session_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/create-checkout-session/route.ts */ \"(rsc)/./src/app/api/create-checkout-session/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/create-checkout-session/route\",\n        pathname: \"/api/create-checkout-session\",\n        filename: \"route\",\n        bundlePath: \"app/api/create-checkout-session/route\"\n    },\n    resolvedPagePath: \"/Users/tomaszgt/Mytechglasses/my-tech-glasses/src/app/api/create-checkout-session/route.ts\",\n    nextConfigOutput,\n    userland: _Users_tomaszgt_Mytechglasses_my_tech_glasses_src_app_api_create_checkout_session_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/create-checkout-session/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZjcmVhdGUtY2hlY2tvdXQtc2Vzc2lvbiUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGY3JlYXRlLWNoZWNrb3V0LXNlc3Npb24lMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZjcmVhdGUtY2hlY2tvdXQtc2Vzc2lvbiUyRnJvdXRlLnRzJmFwcERpcj0lMkZVc2VycyUyRnRvbWFzemd0JTJGTXl0ZWNoZ2xhc3NlcyUyRm15LXRlY2gtZ2xhc3NlcyUyRnNyYyUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZ0b21hc3pndCUyRk15dGVjaGdsYXNzZXMlMkZteS10ZWNoLWdsYXNzZXMmaXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQzBDO0FBQ3ZIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktdGVjaC1nbGFzc2VzLz81NzI4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi9Vc2Vycy90b21hc3pndC9NeXRlY2hnbGFzc2VzL215LXRlY2gtZ2xhc3Nlcy9zcmMvYXBwL2FwaS9jcmVhdGUtY2hlY2tvdXQtc2Vzc2lvbi9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvY3JlYXRlLWNoZWNrb3V0LXNlc3Npb24vcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9jcmVhdGUtY2hlY2tvdXQtc2Vzc2lvblwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvY3JlYXRlLWNoZWNrb3V0LXNlc3Npb24vcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCIvVXNlcnMvdG9tYXN6Z3QvTXl0ZWNoZ2xhc3Nlcy9teS10ZWNoLWdsYXNzZXMvc3JjL2FwcC9hcGkvY3JlYXRlLWNoZWNrb3V0LXNlc3Npb24vcm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2NyZWF0ZS1jaGVja291dC1zZXNzaW9uL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcreate-checkout-session%2Froute&page=%2Fapi%2Fcreate-checkout-session%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcreate-checkout-session%2Froute.ts&appDir=%2FUsers%2Ftomaszgt%2FMytechglasses%2Fmy-tech-glasses%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftomaszgt%2FMytechglasses%2Fmy-tech-glasses&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/create-checkout-session/route.ts":
/*!******************************************************!*\
  !*** ./src/app/api/create-checkout-session/route.ts ***!
  \******************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_stripe__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/stripe */ \"(rsc)/./src/lib/stripe.ts\");\n/* harmony import */ var _lib_cart__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/cart */ \"(rsc)/./src/lib/cart.ts\");\n\n\n\n// ============================================================================\n// VALIDATION FUNCTIONS\n// ============================================================================\nconst validateRequest = (data)=>{\n    const errors = [];\n    // Validate items\n    if (!data.items || !Array.isArray(data.items)) {\n        errors.push(\"Items array is required\");\n    } else if (data.items.length === 0) {\n        errors.push(\"Cart cannot be empty\");\n    }\n    // Validate customer info if provided\n    if (data.customerInfo) {\n        const { firstName, lastName, email, phone } = data.customerInfo;\n        if (!firstName || typeof firstName !== \"string\" || firstName.trim().length === 0) {\n            errors.push(\"Customer first name is required\");\n        }\n        if (!lastName || typeof lastName !== \"string\" || lastName.trim().length === 0) {\n            errors.push(\"Customer last name is required\");\n        }\n        if (!email || typeof email !== \"string\" || !email.includes(\"@\")) {\n            errors.push(\"Valid customer email is required\");\n        }\n        if (!phone || typeof phone !== \"string\" || phone.trim().length === 0) {\n            errors.push(\"Customer phone is required\");\n        }\n    }\n    // Validate shipping address if provided\n    if (data.shippingAddress) {\n        const { line1, city, postal_code, country } = data.shippingAddress;\n        if (!line1 || typeof line1 !== \"string\" || line1.trim().length === 0) {\n            errors.push(\"Shipping address line 1 is required\");\n        }\n        if (!city || typeof city !== \"string\" || city.trim().length === 0) {\n            errors.push(\"Shipping city is required\");\n        }\n        if (!postal_code || typeof postal_code !== \"string\" || postal_code.trim().length === 0) {\n            errors.push(\"Shipping postal code is required\");\n        }\n        if (!country || typeof country !== \"string\" || country.trim().length === 0) {\n            errors.push(\"Shipping country is required\");\n        }\n    }\n    // Validate shipping option if provided\n    if (data.shippingOption && typeof data.shippingOption === \"string\") {\n        const validOptions = _lib_cart__WEBPACK_IMPORTED_MODULE_2__.SHIPPING_OPTIONS.map((option)=>option.id);\n        if (!validOptions.includes(data.shippingOption)) {\n            errors.push(`Invalid shipping option. Must be one of: ${validOptions.join(\", \")}`);\n        }\n    }\n    return {\n        isValid: errors.length === 0,\n        errors\n    };\n};\n// ============================================================================\n// HELPER FUNCTIONS\n// ============================================================================\nconst createErrorResponse = (message, status = 500, details, code)=>{\n    const errorResponse = {\n        error: message,\n        timestamp: new Date().toISOString(),\n        ...details && {\n            details\n        },\n        ...code && {\n            code\n        }\n    };\n    console.error(\"API Error:\", {\n        message,\n        details,\n        code,\n        status,\n        timestamp: errorResponse.timestamp\n    });\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(errorResponse, {\n        status\n    });\n};\nconst generateOrderId = ()=>{\n    const timestamp = Date.now().toString(36);\n    const random = Math.random().toString(36).substr(2, 5);\n    return `MTG-${timestamp}-${random}`.toUpperCase();\n};\nconst buildShippingOptions = (subtotal, selectedOption)=>{\n    return _lib_cart__WEBPACK_IMPORTED_MODULE_2__.SHIPPING_OPTIONS.map((option)=>{\n        // Free shipping for standard option if over threshold\n        const amount = option.id === \"standard\" && subtotal >= 2000 ? 0 : option.price * 100 // Convert to grosze\n        ;\n        return {\n            shipping_rate_data: {\n                type: \"fixed_amount\",\n                fixed_amount: {\n                    amount,\n                    currency: \"pln\"\n                },\n                display_name: option.name,\n                delivery_estimate: {\n                    minimum: {\n                        unit: \"business_day\",\n                        value: option.estimatedDays.min\n                    },\n                    maximum: {\n                        unit: \"business_day\",\n                        value: option.estimatedDays.max\n                    }\n                }\n            }\n        };\n    });\n};\n// ============================================================================\n// MAIN API HANDLER\n// ============================================================================\nasync function POST(request) {\n    const startTime = Date.now();\n    try {\n        // Parse and validate request body\n        let requestData;\n        try {\n            requestData = await request.json();\n        } catch (parseError) {\n            return createErrorResponse(\"Invalid JSON in request body\", 400, parseError instanceof Error ? parseError.message : \"JSON parse failed\", \"INVALID_JSON\");\n        }\n        // Validate request structure\n        const requestValidation = validateRequest(requestData);\n        if (!requestValidation.isValid) {\n            return createErrorResponse(\"Request validation failed\", 400, requestValidation.errors.join(\", \"), \"VALIDATION_ERROR\");\n        }\n        // Validate cart items using our cart utilities\n        const cartValidation = (0,_lib_cart__WEBPACK_IMPORTED_MODULE_2__.validateCartForCheckout)(requestData.items);\n        if (!cartValidation.isValid) {\n            return createErrorResponse(\"Cart validation failed\", 400, cartValidation.errors.join(\", \"), \"CART_VALIDATION_ERROR\");\n        }\n        // Calculate cart summary for metadata\n        const cartSummary = (0,_lib_cart__WEBPACK_IMPORTED_MODULE_2__.calculateCartSummary)(requestData.items, requestData.shippingOption || \"standard\");\n        // Convert items to Stripe format using our utility\n        const lineItems = (0,_lib_cart__WEBPACK_IMPORTED_MODULE_2__.convertToStripeLineItems)(requestData.items);\n        // Generate unique order ID\n        const orderId = generateOrderId();\n        // Get Stripe instance\n        const stripe = (0,_lib_stripe__WEBPACK_IMPORTED_MODULE_1__.getStripeServer)();\n        // Build comprehensive metadata\n        const metadata = {\n            orderId,\n            orderType: \"tech_glasses\",\n            itemCount: cartSummary.itemCount.toString(),\n            subtotal: cartSummary.subtotal.toString(),\n            shipping: cartSummary.shipping.toString(),\n            tax: cartSummary.tax.toString(),\n            total: cartSummary.total.toString(),\n            currency: cartSummary.currency,\n            shippingOption: requestData.shippingOption || \"standard\",\n            newsletter: requestData.newsletter ? \"true\" : \"false\",\n            createdAt: new Date().toISOString(),\n            ...requestData.customerInfo && {\n                customerName: `${requestData.customerInfo.firstName} ${requestData.customerInfo.lastName}`,\n                customerPhone: requestData.customerInfo.phone\n            }\n        };\n        // Build shipping options with dynamic pricing\n        const shippingOptions = buildShippingOptions(cartSummary.subtotal, requestData.shippingOption);\n        // Create Stripe checkout session with Polish payment methods\n        const session = await stripe.checkout.sessions.create({\n            payment_method_types: [\n                \"card\",\n                \"blik\",\n                \"p24\"\n            ],\n            mode: \"payment\",\n            line_items: lineItems,\n            success_url: `${request.nextUrl.origin}/success?session_id={CHECKOUT_SESSION_ID}`,\n            cancel_url: `${request.nextUrl.origin}/checkout?cancelled=true`,\n            // Customer information for Polish payment methods\n            ...requestData.customerInfo && {\n                customer_email: requestData.customerInfo.email\n            },\n            // Billing address collection for P24\n            billing_address_collection: \"required\",\n            // Locale for Polish users\n            locale: \"pl\",\n            // Currency\n            currency: \"pln\",\n            // Metadata\n            metadata: {\n                orderId: generateOrderId(),\n                customerEmail: requestData.customerInfo?.email || \"unknown\"\n            }\n        });\n        // Log successful session creation\n        console.log(\"Checkout session created successfully:\", {\n            sessionId: session.id,\n            orderId,\n            customerEmail: requestData.customerInfo?.email,\n            itemCount: cartSummary.itemCount,\n            total: cartSummary.total,\n            processingTime: Date.now() - startTime\n        });\n        // Return session ID\n        const response = {\n            sessionId: session.id\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(response, {\n            status: 200,\n            headers: {\n                \"Cache-Control\": \"no-cache, no-store, must-revalidate\",\n                \"Pragma\": \"no-cache\",\n                \"Expires\": \"0\"\n            }\n        });\n    } catch (error) {\n        // Handle Stripe-specific errors\n        if (error && typeof error === \"object\" && \"type\" in error) {\n            const stripeError = error;\n            switch(stripeError.type){\n                case \"StripeCardError\":\n                    return createErrorResponse(\"Card was declined\", 400, stripeError.message, \"CARD_DECLINED\");\n                case \"StripeRateLimitError\":\n                    return createErrorResponse(\"Too many requests made to the API too quickly\", 429, stripeError.message, \"RATE_LIMIT\");\n                case \"StripeInvalidRequestError\":\n                    return createErrorResponse(\"Invalid parameters were supplied to Stripe API\", 400, stripeError.message, \"INVALID_REQUEST\");\n                case \"StripeAPIError\":\n                    return createErrorResponse(\"An error occurred internally with Stripe API\", 500, stripeError.message, \"STRIPE_API_ERROR\");\n                case \"StripeConnectionError\":\n                    return createErrorResponse(\"Some kind of error occurred during the HTTPS communication\", 503, stripeError.message, \"CONNECTION_ERROR\");\n                case \"StripeAuthenticationError\":\n                    return createErrorResponse(\"You probably used an incorrect API key\", 401, stripeError.message, \"AUTHENTICATION_ERROR\");\n                default:\n                    return createErrorResponse(\"An error occurred with our payment processor\", 500, stripeError.message, \"STRIPE_ERROR\");\n            }\n        }\n        // Handle general errors\n        const errorMessage = error instanceof Error ? error.message : \"Unknown error occurred\";\n        return createErrorResponse(\"Failed to create checkout session\", 500, errorMessage, \"INTERNAL_ERROR\");\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9jcmVhdGUtY2hlY2tvdXQtc2Vzc2lvbi9yb3V0ZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQXVEO0FBQ1Q7QUFPM0I7QUFtQ25CLCtFQUErRTtBQUMvRSx1QkFBdUI7QUFDdkIsK0VBQStFO0FBRS9FLE1BQU1NLGtCQUFrQixDQUFDQztJQUN2QixNQUFNQyxTQUFtQixFQUFFO0lBRTNCLGlCQUFpQjtJQUNqQixJQUFJLENBQUNELEtBQUtFLEtBQUssSUFBSSxDQUFDQyxNQUFNQyxPQUFPLENBQUNKLEtBQUtFLEtBQUssR0FBRztRQUM3Q0QsT0FBT0ksSUFBSSxDQUFDO0lBQ2QsT0FBTyxJQUFJTCxLQUFLRSxLQUFLLENBQUNJLE1BQU0sS0FBSyxHQUFHO1FBQ2xDTCxPQUFPSSxJQUFJLENBQUM7SUFDZDtJQUVBLHFDQUFxQztJQUNyQyxJQUFJTCxLQUFLTyxZQUFZLEVBQUU7UUFDckIsTUFBTSxFQUFFQyxTQUFTLEVBQUVDLFFBQVEsRUFBRUMsS0FBSyxFQUFFQyxLQUFLLEVBQUUsR0FBR1gsS0FBS08sWUFBWTtRQUUvRCxJQUFJLENBQUNDLGFBQWEsT0FBT0EsY0FBYyxZQUFZQSxVQUFVSSxJQUFJLEdBQUdOLE1BQU0sS0FBSyxHQUFHO1lBQ2hGTCxPQUFPSSxJQUFJLENBQUM7UUFDZDtRQUVBLElBQUksQ0FBQ0ksWUFBWSxPQUFPQSxhQUFhLFlBQVlBLFNBQVNHLElBQUksR0FBR04sTUFBTSxLQUFLLEdBQUc7WUFDN0VMLE9BQU9JLElBQUksQ0FBQztRQUNkO1FBRUEsSUFBSSxDQUFDSyxTQUFTLE9BQU9BLFVBQVUsWUFBWSxDQUFDQSxNQUFNRyxRQUFRLENBQUMsTUFBTTtZQUMvRFosT0FBT0ksSUFBSSxDQUFDO1FBQ2Q7UUFFQSxJQUFJLENBQUNNLFNBQVMsT0FBT0EsVUFBVSxZQUFZQSxNQUFNQyxJQUFJLEdBQUdOLE1BQU0sS0FBSyxHQUFHO1lBQ3BFTCxPQUFPSSxJQUFJLENBQUM7UUFDZDtJQUNGO0lBRUEsd0NB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TCxnREFDQSxLQUNBaUYsWUFBWWhGLE9BQU8sRUFDbkI7Z0JBR0osS0FBSztvQkFDSCxPQUFPRCxvQkFDTCw4REFDQSxLQUNBaUYsWUFBWWhGLE9BQU8sRUFDbkI7Z0JBR0osS0FBSztvQkFDSCxPQUFPRCxvQkFDTCwwQ0FDQSxLQUNBaUYsWUFBWWhGLE9BQU8sRUFDbkI7Z0JBR0o7b0JBQ0UsT0FBT0Qsb0JBQ0wsZ0RBQ0EsS0FDQWlGLFlBQVloRixPQUFPLEVBQ25CO1lBRU47UUFDRjtRQUVBLHdCQUF3QjtRQUN4QixNQUFNaUYsZUFBZTVFLGlCQUFpQnFDLFFBQVFyQyxNQUFNTCxPQUFPLEdBQUc7UUFFOUQsT0FBT0Qsb0JBQ0wscUNBQ0EsS0FDQWtGLGNBQ0E7SUFFSjtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vbXktdGVjaC1nbGFzc2VzLy4vc3JjL2FwcC9hcGkvY3JlYXRlLWNoZWNrb3V0LXNlc3Npb24vcm91dGUudHM/NTBkMiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInXG5pbXBvcnQgeyBnZXRTdHJpcGVTZXJ2ZXIgfSBmcm9tICdAL2xpYi9zdHJpcGUnXG5pbXBvcnQgeyBcbiAgdmFsaWRhdGVDYXJ0Rm9yQ2hlY2tvdXQsIFxuICBjb252ZXJ0VG9TdHJpcGVMaW5lSXRlbXMsIFxuICBTSElQUElOR19PUFRJT05TLFxuICBjYWxjdWxhdGVDYXJ0U3VtbWFyeSxcbiAgQ2FydEl0ZW0gXG59IGZyb20gJ0AvbGliL2NhcnQnXG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFRZUEVTIEFORCBJTlRFUkZBQ0VTXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmludGVyZmFjZSBDaGVja291dFNlc3Npb25SZXF1ZXN0IHtcbiAgaXRlbXM6IENhcnRJdGVtW11cbiAgY3VzdG9tZXJJbmZvPzoge1xuICAgIGZpcnN0TmFtZTogc3RyaW5nXG4gICAgbGFzdE5hbWU6IHN0cmluZ1xuICAgIGVtYWlsOiBzdHJpbmdcbiAgICBwaG9uZTogc3RyaW5nXG4gIH1cbiAgc2hpcHBpbmdBZGRyZXNzPzoge1xuICAgIGxpbmUxOiBzdHJpbmdcbiAgICBjaXR5OiBzdHJpbmdcbiAgICBwb3N0YWxfY29kZTogc3RyaW5nXG4gICAgY291bnRyeTogc3RyaW5nXG4gIH1cbiAgc2hpcHBpbmdPcHRpb24/OiBzdHJpbmdcbiAgbmV3c2xldHRlcj86IGJvb2xlYW5cbn1cblxuaW50ZXJmYWNlIENoZWNrb3V0U2Vzc2lvblJlc3BvbnNlIHtcbiAgc2Vzc2lvbklkOiBzdHJpbmdcbn1cblxuaW50ZXJmYWNlIEVycm9yUmVzcG9uc2Uge1xuICBlcnJvcjogc3RyaW5nXG4gIGRldGFpbHM/OiBzdHJpbmdcbiAgY29kZT86IHN0cmluZ1xuICB0aW1lc3RhbXA6IHN0cmluZ1xufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBWQUxJREFUSU9OIEZVTkNUSU9OU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5jb25zdCB2YWxpZGF0ZVJlcXVlc3QgPSAoZGF0YTogYW55KTogeyBpc1ZhbGlkOiBib29sZWFuOyBlcnJvcnM6IHN0cmluZ1tdIH0gPT4ge1xuICBjb25zdCBlcnJvcnM6IHN0cmluZ1tdID0gW11cblxuICAvLyBWYWxpZGF0ZSBpdGVtc1xuICBpZiAoIWRhdGEuaXRlbXMgfHwgIUFycmF5LmlzQXJyYXkoZGF0YS5pdGVtcykpIHtcbiAgICBlcnJvcnMucHVzaCgnSXRlbXMgYXJyYXkgaXMgcmVxdWlyZWQnKVxuICB9IGVsc2UgaWYgKGRhdGEuaXRlbXMubGVuZ3RoID09PSAwKSB7XG4gICAgZXJyb3JzLnB1c2goJ0NhcnQgY2Fubm90IGJlIGVtcHR5JylcbiAgfVxuXG4gIC8vIFZhbGlkYXRlIGN1c3RvbWVyIGluZm8gaWYgcHJvdmlkZWRcbiAgaWYgKGRhdGEuY3VzdG9tZXJJbmZvKSB7XG4gICAgY29uc3QgeyBmaXJzdE5hbWUsIGxhc3ROYW1lLCBlbWFpbCwgcGhvbmUgfSA9IGRhdGEuY3VzdG9tZXJJbmZvXG4gICAgXG4gICAgaWYgKCFmaXJzdE5hbWUgfHwgdHlwZW9mIGZpcnN0TmFtZSAhPT0gJ3N0cmluZycgfHwgZmlyc3ROYW1lLnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgIGVycm9ycy5wdXNoKCdDdXN0b21lciBmaXJzdCBuYW1lIGlzIHJlcXVpcmVkJylcbiAgICB9XG4gICAgXG4gICAgaWYgKCFsYXN0TmFtZSB8fCB0eXBlb2YgbGFzdE5hbWUgIT09ICdzdHJpbmcnIHx8IGxhc3ROYW1lLnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgIGVycm9ycy5wdXNoKCdDdXN0b21lciBsYXN0IG5hbWUgaXMgcmVxdWlyZWQnKVxuICAgIH1cbiAgICBcbiAgICBpZiAoIWVtYWlsIHx8IHR5cGVvZiBlbWFpbCAhPT0gJ3N0cmluZycgfHwgIWVtYWlsLmluY2x1ZGVzKCdAJykpIHtcbiAgICAgIGVycm9ycy5wdXNoKCdWYWxpZCBjdXN0b21lciBlbWFpbCBpcyByZXF1aXJlZCcpXG4gICAgfVxuICAgIFxuICAgIGlmICghcGhvbmUgfHwgdHlwZW9mIHBob25lICE9PSAnc3RyaW5nJyB8fCBwaG9uZS50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICBlcnJvcnMucHVzaCgnQ3VzdG9tZXIgcGhvbmUgaXMgcmVxdWlyZWQnKVxuICAgIH1cbiAgfVxuXG4gIC8vIFZhbGlkYXRlIHNoaXBwaW5nIGFkZHJlc3MgaWYgcHJvdmlkZWRcbiAgaWYgKGRhdGEuc2hpcHBpbmdBZGRyZXNzKSB7XG4gICAgY29uc3QgeyBsaW5lMSwgY2l0eSwgcG9zdGFsX2NvZGUsIGNvdW50cnkgfSA9IGRhdGEuc2hpcHBpbmdBZGRyZXNzXG4gICAgXG4gICAgaWYgKCFsaW5lMSB8fCB0eXBlb2YgbGluZTEgIT09ICdzdHJpbmcnIHx8IGxpbmUxLnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICAgIGVycm9ycy5wdXNoKCdTaGlwcGluZyBhZGRyZXNzIGxpbmUgMSBpcyByZXF1aXJlZCcpXG4gICAgfVxuICAgIFxuICAgIGlmICghY2l0eSB8fCB0eXBlb2YgY2l0eSAhPT0gJ3N0cmluZycgfHwgY2l0eS50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICBlcnJvcnMucHVzaCgnU2hpcHBpbmcgY2l0eSBpcyByZXF1aXJlZCcpXG4gICAgfVxuICAgIFxuICAgIGlmICghcG9zdGFsX2NvZGUgfHwgdHlwZW9mIHBvc3RhbF9jb2RlICE9PSAnc3RyaW5nJyB8fCBwb3N0YWxfY29kZS50cmltKCkubGVuZ3RoID09PSAwKSB7XG4gICAgICBlcnJvcnMucHVzaCgnU2hpcHBpbmcgcG9zdGFsIGNvZGUgaXMgcmVxdWlyZWQnKVxuICAgIH1cbiAgICBcbiAgICBpZiAoIWNvdW50cnkgfHwgdHlwZW9mIGNvdW50cnkgIT09ICdzdHJpbmcnIHx8IGNvdW50cnkudHJpbSgpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgZXJyb3JzLnB1c2goJ1NoaXBwaW5nIGNvdW50cnkgaXMgcmVxdWlyZWQnKVxuICAgIH1cbiAgfVxuXG4gIC8vIFZhbGlkYXRlIHNoaXBwaW5nIG9wdGlvbiBpZiBwcm92aWRlZFxuICBpZiAoZGF0YS5zaGlwcGluZ09wdGlvbiAmJiB0eXBlb2YgZGF0YS5zaGlwcGluZ09wdGlvbiA9PT0gJ3N0cmluZycpIHtcbiAgICBjb25zdCB2YWxpZE9wdGlvbnMgPSBTSElQUElOR19PUFRJT05TLm1hcChvcHRpb24gPT4gb3B0aW9uLmlkKVxuICAgIGlmICghdmFsaWRPcHRpb25zLmluY2x1ZGVzKGRhdGEuc2hpcHBpbmdPcHRpb24pKSB7XG4gICAgICBlcnJvcnMucHVzaChgSW52YWxpZCBzaGlwcGluZyBvcHRpb24uIE11c3QgYmUgb25lIG9mOiAke3ZhbGlkT3B0aW9ucy5qb2luKCcsICcpfWApXG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBpc1ZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxuICAgIGVycm9yc1xuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEhFTFBFUiBGVU5DVElPTlNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuY29uc3QgY3JlYXRlRXJyb3JSZXNwb25zZSA9IChcbiAgbWVzc2FnZTogc3RyaW5nLCBcbiAgc3RhdHVzOiBudW1iZXIgPSA1MDAsIFxuICBkZXRhaWxzPzogc3RyaW5nLFxuICBjb2RlPzogc3RyaW5nXG4pOiBOZXh0UmVzcG9uc2UgPT4ge1xuICBjb25zdCBlcnJvclJlc3BvbnNlOiBFcnJvclJlc3BvbnNlID0ge1xuICAgIGVycm9yOiBtZXNzYWdlLFxuICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgIC4uLihkZXRhaWxzICYmIHsgZGV0YWlscyB9KSxcbiAgICAuLi4oY29kZSAmJiB7IGNvZGUgfSlcbiAgfVxuXG4gIGNvbnNvbGUuZXJyb3IoJ0FQSSBFcnJvcjonLCB7XG4gICAgbWVzc2FnZSxcbiAgICBkZXRhaWxzLFxuICAgIGNvZGUsXG4gICAgc3RhdHVzLFxuICAgIHRpbWVzdGFtcDogZXJyb3JSZXNwb25zZS50aW1lc3RhbXBcbiAgfSlcblxuICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oZXJyb3JSZXNwb25zZSwgeyBzdGF0dXMgfSlcbn1cblxuY29uc3QgZ2VuZXJhdGVPcmRlcklkID0gKCk6IHN0cmluZyA9PiB7XG4gIGNvbnN0IHRpbWVzdGFtcCA9IERhdGUubm93KCkudG9TdHJpbmcoMzYpXG4gIGNvbnN0IHJhbmRvbSA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cigyLCA1KVxuICByZXR1cm4gYE1URy0ke3RpbWVzdGFtcH0tJHtyYW5kb219YC50b1VwcGVyQ2FzZSgpXG59XG5cbmNvbnN0IGJ1aWxkU2hpcHBpbmdPcHRpb25zID0gKHN1YnRvdGFsOiBudW1iZXIsIHNlbGVjdGVkT3B0aW9uPzogc3RyaW5nKSA9PiB7XG4gIHJldHVybiBTSElQUElOR19PUFRJT05TLm1hcChvcHRpb24gPT4ge1xuICAgIC8vIEZyZWUgc2hpcHBpbmcgZm9yIHN0YW5kYXJkIG9wdGlvbiBpZiBvdmVyIHRocmVzaG9sZFxuICAgIGNvbnN0IGFtb3VudCA9IChvcHRpb24uaWQgPT09ICdzdGFuZGFyZCcgJiYgc3VidG90YWwgPj0gMjAwMCkgXG4gICAgICA/IDAgXG4gICAgICA6IG9wdGlvbi5wcmljZSAqIDEwMCAvLyBDb252ZXJ0IHRvIGdyb3N6ZVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHNoaXBwaW5nX3JhdGVfZGF0YToge1xuICAgICAgICB0eXBlOiAnZml4ZWRfYW1vdW50JyBhcyBjb25zdCxcbiAgICAgICAgZml4ZWRfYW1vdW50OiB7XG4gICAgICAgICAgYW1vdW50LFxuICAgICAgICAgIGN1cnJlbmN5OiAncGxuJyxcbiAgICAgICAgfSxcbiAgICAgICAgZGlzcGxheV9uYW1lOiBvcHRpb24ubmFtZSxcbiAgICAgICAgZGVsaXZlcnlfZXN0aW1hdGU6IHtcbiAgICAgICAgICBtaW5pbXVtOiB7XG4gICAgICAgICAgICB1bml0OiAnYnVzaW5lc3NfZGF5JyBhcyBjb25zdCxcbiAgICAgICAgICAgIHZhbHVlOiBvcHRpb24uZXN0aW1hdGVkRGF5cy5taW4sXG4gICAgICAgICAgfSxcbiAgICAgICAgICBtYXhpbXVtOiB7XG4gICAgICAgICAgICB1bml0OiAnYnVzaW5lc3NfZGF5JyBhcyBjb25zdCxcbiAgICAgICAgICAgIHZhbHVlOiBvcHRpb24uZXN0aW1hdGVkRGF5cy5tYXgsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgfVxuICB9KVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBNQUlOIEFQSSBIQU5ETEVSXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBQT1NUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KClcbiAgXG4gIHRyeSB7XG4gICAgLy8gUGFyc2UgYW5kIHZhbGlkYXRlIHJlcXVlc3QgYm9keVxuICAgIGxldCByZXF1ZXN0RGF0YTogQ2hlY2tvdXRTZXNzaW9uUmVxdWVzdFxuICAgIFxuICAgIHRyeSB7XG4gICAgICByZXF1ZXN0RGF0YSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXG4gICAgfSBjYXRjaCAocGFyc2VFcnJvcikge1xuICAgICAgcmV0dXJuIGNyZWF0ZUVycm9yUmVzcG9uc2UoXG4gICAgICAgICdJbnZhbGlkIEpTT04gaW4gcmVxdWVzdCBib2R5JyxcbiAgICAgICAgNDAwLFxuICAgICAgICBwYXJzZUVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBwYXJzZUVycm9yLm1lc3NhZ2UgOiAnSlNPTiBwYXJzZSBmYWlsZWQnLFxuICAgICAgICAnSU5WQUxJRF9KU09OJ1xuICAgICAgKVxuICAgIH1cblxuICAgIC8vIFZhbGlkYXRlIHJlcXVlc3Qgc3RydWN0dXJlXG4gICAgY29uc3QgcmVxdWVzdFZhbGlkYXRpb24gPSB2YWxpZGF0ZVJlcXVlc3QocmVxdWVzdERhdGEpXG4gICAgaWYgKCFyZXF1ZXN0VmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgICByZXR1cm4gY3JlYXRlRXJyb3JSZXNwb25zZShcbiAgICAgICAgJ1JlcXVlc3QgdmFsaWRhdGlvbiBmYWlsZWQnLFxuICAgICAgICA0MDAsXG4gICAgICAgIHJlcXVlc3RWYWxpZGF0aW9uLmVycm9ycy5qb2luKCcsICcpLFxuICAgICAgICAnVkFMSURBVElPTl9FUlJPUidcbiAgICAgIClcbiAgICB9XG5cbiAgICAvLyBWYWxpZGF0ZSBjYXJ0IGl0ZW1zIHVzaW5nIG91ciBjYXJ0IHV0aWxpdGllc1xuICAgIGNvbnN0IGNhcnRWYWxpZGF0aW9uID0gdmFsaWRhdGVDYXJ0Rm9yQ2hlY2tvdXQocmVxdWVzdERhdGEuaXRlbXMpXG4gICAgaWYgKCFjYXJ0VmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgICByZXR1cm4gY3JlYXRlRXJyb3JSZXNwb25zZShcbiAgICAgICAgJ0NhcnQgdmFsaWRhdGlvbiBmYWlsZWQnLFxuICAgICAgICA0MDAsXG4gICAgICAgIGNhcnRWYWxpZGF0aW9uLmVycm9ycy5qb2luKCcsICcpLFxuICAgICAgICAnQ0FSVF9WQUxJREFUSU9OX0VSUk9SJ1xuICAgICAgKVxuICAgIH1cblxuICAgIC8vIENhbGN1bGF0ZSBjYXJ0IHN1bW1hcnkgZm9yIG1ldGFkYXRhXG4gICAgY29uc3QgY2FydFN1bW1hcnkgPSBjYWxjdWxhdGVDYXJ0U3VtbWFyeShcbiAgICAgIHJlcXVlc3REYXRhLml0ZW1zLFxuICAgICAgcmVxdWVzdERhdGEuc2hpcHBpbmdPcHRpb24gfHwgJ3N0YW5kYXJkJ1xuICAgIClcblxuICAgIC8vIENvbnZlcnQgaXRlbXMgdG8gU3RyaXBlIGZvcm1hdCB1c2luZyBvdXIgdXRpbGl0eVxuICAgIGNvbnN0IGxpbmVJdGVtcyA9IGNvbnZlcnRUb1N0cmlwZUxpbmVJdGVtcyhyZXF1ZXN0RGF0YS5pdGVtcylcblxuICAgIC8vIEdlbmVyYXRlIHVuaXF1ZSBvcmRlciBJRFxuICAgIGNvbnN0IG9yZGVySWQgPSBnZW5lcmF0ZU9yZGVySWQoKVxuXG4gICAgLy8gR2V0IFN0cmlwZSBpbnN0YW5jZVxuICAgIGNvbnN0IHN0cmlwZSA9IGdldFN0cmlwZVNlcnZlcigpXG5cbiAgICAvLyBCdWlsZCBjb21wcmVoZW5zaXZlIG1ldGFkYXRhXG4gICAgY29uc3QgbWV0YWRhdGEgPSB7XG4gICAgICBvcmRlcklkLFxuICAgICAgb3JkZXJUeXBlOiAndGVjaF9nbGFzc2VzJyxcbiAgICAgIGl0ZW1Db3VudDogY2FydFN1bW1hcnkuaXRlbUNvdW50LnRvU3RyaW5nKCksXG4gICAgICBzdWJ0b3RhbDogY2FydFN1bW1hcnkuc3VidG90YWwudG9TdHJpbmcoKSxcbiAgICAgIHNoaXBwaW5nOiBjYXJ0U3VtbWFyeS5zaGlwcGluZy50b1N0cmluZygpLFxuICAgICAgdGF4OiBjYXJ0U3VtbWFyeS50YXgudG9TdHJpbmcoKSxcbiAgICAgIHRvdGFsOiBjYXJ0U3VtbWFyeS50b3RhbC50b1N0cmluZygpLFxuICAgICAgY3VycmVuY3k6IGNhcnRTdW1tYXJ5LmN1cnJlbmN5LFxuICAgICAgc2hpcHBpbmdPcHRpb246IHJlcXVlc3REYXRhLnNoaXBwaW5nT3B0aW9uIHx8ICdzdGFuZGFyZCcsXG4gICAgICBuZXdzbGV0dGVyOiByZXF1ZXN0RGF0YS5uZXdzbGV0dGVyID8gJ3RydWUnIDogJ2ZhbHNlJyxcbiAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgLi4uKHJlcXVlc3REYXRhLmN1c3RvbWVySW5mbyAmJiB7XG4gICAgICAgIGN1c3RvbWVyTmFtZTogYCR7cmVxdWVzdERhdGEuY3VzdG9tZXJJbmZvLmZpcnN0TmFtZX0gJHtyZXF1ZXN0RGF0YS5jdXN0b21lckluZm8ubGFzdE5hbWV9YCxcbiAgICAgICAgY3VzdG9tZXJQaG9uZTogcmVxdWVzdERhdGEuY3VzdG9tZXJJbmZvLnBob25lXG4gICAgICB9KVxuICAgIH1cblxuICAgIC8vIEJ1aWxkIHNoaXBwaW5nIG9wdGlvbnMgd2l0aCBkeW5hbWljIHByaWNpbmdcbiAgICBjb25zdCBzaGlwcGluZ09wdGlvbnMgPSBidWlsZFNoaXBwaW5nT3B0aW9ucyhjYXJ0U3VtbWFyeS5zdWJ0b3RhbCwgcmVxdWVzdERhdGEuc2hpcHBpbmdPcHRpb24pXG5cbiAgICAvLyBDcmVhdGUgU3RyaXBlIGNoZWNrb3V0IHNlc3Npb24gd2l0aCBQb2xpc2ggcGF5bWVudCBtZXRob2RzXG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IHN0cmlwZS5jaGVja291dC5zZXNzaW9ucy5jcmVhdGUoe1xuICAgICAgcGF5bWVudF9tZXRob2RfdHlwZXM6IFsnY2FyZCcsICdibGlrJywgJ3AyNCddLFxuICAgICAgbW9kZTogJ3BheW1lbnQnLFxuICAgICAgbGluZV9pdGVtczogbGluZUl0ZW1zLFxuICAgICAgc3VjY2Vzc191cmw6IGAke3JlcXVlc3QubmV4dFVybC5vcmlnaW59L3N1Y2Nlc3M/c2Vzc2lvbl9pZD17Q0hFQ0tPVVRfU0VTU0lPTl9JRH1gLFxuICAgICAgY2FuY2VsX3VybDogYCR7cmVxdWVzdC5uZXh0VXJsLm9yaWdpbn0vY2hlY2tvdXQ/Y2FuY2VsbGVkPXRydWVgLFxuICAgICAgXG4gICAgICAvLyBDdXN0b21lciBpbmZvcm1hdGlvbiBmb3IgUG9saXNoIHBheW1lbnQgbWV0aG9kc1xuICAgICAgLi4uKHJlcXVlc3REYXRhLmN1c3RvbWVySW5mbyAmJiB7XG4gICAgICAgIGN1c3RvbWVyX2VtYWlsOiByZXF1ZXN0RGF0YS5jdXN0b21lckluZm8uZW1haWwsXG4gICAgICB9KSxcbiAgICAgIFxuICAgICAgLy8gQmlsbGluZyBhZGRyZXNzIGNvbGxlY3Rpb24gZm9yIFAyNFxuICAgICAgYmlsbGluZ19hZGRyZXNzX2NvbGxlY3Rpb246ICdyZXF1aXJlZCcsXG4gICAgICBcbiAgICAgIC8vIExvY2FsZSBmb3IgUG9saXNoIHVzZXJzXG4gICAgICBsb2NhbGU6ICdwbCcsXG4gICAgICBcbiAgICAgIC8vIEN1cnJlbmN5XG4gICAgICBjdXJyZW5jeTogJ3BsbicsXG4gICAgICBcbiAgICAgIC8vIE1ldGFkYXRhXG4gICAgICBtZXRhZGF0YToge1xuICAgICAgICBvcmRlcklkOiBnZW5lcmF0ZU9yZGVySWQoKSxcbiAgICAgICAgY3VzdG9tZXJFbWFpbDogcmVxdWVzdERhdGEuY3VzdG9tZXJJbmZvPy5lbWFpbCB8fCAndW5rbm93bidcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgLy8gTG9nIHN1Y2Nlc3NmdWwgc2Vzc2lvbiBjcmVhdGlvblxuICAgIGNvbnNvbGUubG9nKCdDaGVja291dCBzZXNzaW9uIGNyZWF0ZWQgc3VjY2Vzc2Z1bGx5OicsIHtcbiAgICAgIHNlc3Npb25JZDogc2Vzc2lvbi5pZCxcbiAgICAgIG9yZGVySWQsXG4gICAgICBjdXN0b21lckVtYWlsOiByZXF1ZXN0RGF0YS5jdXN0b21lckluZm8/LmVtYWlsLFxuICAgICAgaXRlbUNvdW50OiBjYXJ0U3VtbWFyeS5pdGVtQ291bnQsXG4gICAgICB0b3RhbDogY2FydFN1bW1hcnkudG90YWwsXG4gICAgICBwcm9jZXNzaW5nVGltZTogRGF0ZS5ub3coKSAtIHN0YXJ0VGltZVxuICAgIH0pXG5cbiAgICAvLyBSZXR1cm4gc2Vzc2lvbiBJRFxuICAgIGNvbnN0IHJlc3BvbnNlOiBDaGVja291dFNlc3Npb25SZXNwb25zZSA9IHtcbiAgICAgIHNlc3Npb25JZDogc2Vzc2lvbi5pZFxuICAgIH1cblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihyZXNwb25zZSwgeyBcbiAgICAgIHN0YXR1czogMjAwLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQ2FjaGUtQ29udHJvbCc6ICduby1jYWNoZSwgbm8tc3RvcmUsIG11c3QtcmV2YWxpZGF0ZScsXG4gICAgICAgICdQcmFnbWEnOiAnbm8tY2FjaGUnLFxuICAgICAgICAnRXhwaXJlcyc6ICcwJ1xuICAgICAgfVxuICAgIH0pXG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAvLyBIYW5kbGUgU3RyaXBlLXNwZWNpZmljIGVycm9yc1xuICAgIGlmIChlcnJvciAmJiB0eXBlb2YgZXJyb3IgPT09ICdvYmplY3QnICYmICd0eXBlJyBpbiBlcnJvcikge1xuICAgICAgY29uc3Qgc3RyaXBlRXJyb3IgPSBlcnJvciBhcyBhbnlcbiAgICAgIFxuICAgICAgc3dpdGNoIChzdHJpcGVFcnJvci50eXBlKSB7XG4gICAgICAgIGNhc2UgJ1N0cmlwZUNhcmRFcnJvcic6XG4gICAgICAgICAgcmV0dXJuIGNyZWF0ZUVycm9yUmVzcG9uc2UoXG4gICAgICAgICAgICAnQ2FyZCB3YXMgZGVjbGluZWQnLFxuICAgICAgICAgICAgNDAwLFxuICAgICAgICAgICAgc3RyaXBlRXJyb3IubWVzc2FnZSxcbiAgICAgICAgICAgICdDQVJEX0RFQ0xJTkVEJ1xuICAgICAgICAgIClcbiAgICAgICAgXG4gICAgICAgIGNhc2UgJ1N0cmlwZVJhdGVMaW1pdEVycm9yJzpcbiAgICAgICAgICByZXR1cm4gY3JlYXRlRXJyb3JSZXNwb25zZShcbiAgICAgICAgICAgICdUb28gbWFueSByZXF1ZXN0cyBtYWRlIHRvIHRoZSBBUEkgdG9vIHF1aWNrbHknLFxuICAgICAgICAgICAgNDI5LFxuICAgICAgICAgICAgc3RyaXBlRXJyb3IubWVzc2FnZSxcbiAgICAgICAgICAgICdSQVRFX0xJTUlUJ1xuICAgICAgICAgIClcbiAgICAgICAgXG4gICAgICAgIGNhc2UgJ1N0cmlwZUludmFsaWRSZXF1ZXN0RXJyb3InOlxuICAgICAgICAgIHJldHVybiBjcmVhdGVFcnJvclJlc3BvbnNlKFxuICAgICAgICAgICAgJ0ludmFsaWQgcGFyYW1ldGVycyB3ZXJlIHN1cHBsaWVkIHRvIFN0cmlwZSBBUEknLFxuICAgICAgICAgICAgNDAwLFxuICAgICAgICAgICAgc3RyaXBlRXJyb3IubWVzc2FnZSxcbiAgICAgICAgICAgICdJTlZBTElEX1JFUVVFU1QnXG4gICAgICAgICAgKVxuICAgICAgICBcbiAgICAgICAgY2FzZSAnU3RyaXBlQVBJRXJyb3InOlxuICAgICAgICAgIHJldHVybiBjcmVhdGVFcnJvclJlc3BvbnNlKFxuICAgICAgICAgICAgJ0FuIGVycm9yIG9jY3VycmVkIGludGVybmFsbHkgd2l0aCBTdHJpcGUgQVBJJyxcbiAgICAgICAgICAgIDUwMCxcbiAgICAgICAgICAgIHN0cmlwZUVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgICAnU1RSSVBFX0FQSV9FUlJPUidcbiAgICAgICAgICApXG4gICAgICAgIFxuICAgICAgICBjYXNlICdTdHJpcGVDb25uZWN0aW9uRXJyb3InOlxuICAgICAgICAgIHJldHVybiBjcmVhdGVFcnJvclJlc3BvbnNlKFxuICAgICAgICAgICAgJ1NvbWUga2luZCBvZiBlcnJvciBvY2N1cnJlZCBkdXJpbmcgdGhlIEhUVFBTIGNvbW11bmljYXRpb24nLFxuICAgICAgICAgICAgNTAzLFxuICAgICAgICAgICAgc3RyaXBlRXJyb3IubWVzc2FnZSxcbiAgICAgICAgICAgICdDT05ORUNUSU9OX0VSUk9SJ1xuICAgICAgICAgIClcbiAgICAgICAgXG4gICAgICAgIGNhc2UgJ1N0cmlwZUF1dGhlbnRpY2F0aW9uRXJyb3InOlxuICAgICAgICAgIHJldHVybiBjcmVhdGVFcnJvclJlc3BvbnNlKFxuICAgICAgICAgICAgJ1lvdSBwcm9iYWJseSB1c2VkIGFuIGluY29ycmVjdCBBUEkga2V5JyxcbiAgICAgICAgICAgIDQwMSxcbiAgICAgICAgICAgIHN0cmlwZUVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgICAnQVVUSEVOVElDQVRJT05fRVJST1InXG4gICAgICAgICAgKVxuICAgICAgICBcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICByZXR1cm4gY3JlYXRlRXJyb3JSZXNwb25zZShcbiAgICAgICAgICAgICdBbiBlcnJvciBvY2N1cnJlZCB3aXRoIG91ciBwYXltZW50IHByb2Nlc3NvcicsXG4gICAgICAgICAgICA1MDAsXG4gICAgICAgICAgICBzdHJpcGVFcnJvci5tZXNzYWdlLFxuICAgICAgICAgICAgJ1NUUklQRV9FUlJPUidcbiAgICAgICAgICApXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIGdlbmVyYWwgZXJyb3JzXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvciBvY2N1cnJlZCdcbiAgICBcbiAgICByZXR1cm4gY3JlYXRlRXJyb3JSZXNwb25zZShcbiAgICAgICdGYWlsZWQgdG8gY3JlYXRlIGNoZWNrb3V0IHNlc3Npb24nLFxuICAgICAgNTAwLFxuICAgICAgZXJyb3JNZXNzYWdlLFxuICAgICAgJ0lOVEVSTkFMX0VSUk9SJ1xuICAgIClcbiAgfVxufSJdLCJuYW1lcyI6WyJOZXh0UmVzcG9uc2UiLCJnZXRTdHJpcGVTZXJ2ZXIiLCJ2YWxpZGF0ZUNhcnRGb3JDaGVja291dCIsImNvbnZlcnRUb1N0cmlwZUxpbmVJdGVtcyIsIlNISVBQSU5HX09QVElPTlMiLCJjYWxjdWxhdGVDYXJ0U3VtbWFyeSIsInZhbGlkYXRlUmVxdWVzdCIsImRhdGEiLCJlcnJvcnMiLCJpdGVtcyIsIkFycmF5IiwiaXNBcnJheSIsInB1c2giLCJsZW5ndGgiLCJjdXN0b21lckluZm8iLCJmaXJzdE5hbWUiLCJsYXN0TmFtZSIsImVtYWlsIiwicGhvbmUiLCJ0cmltIiwiaW5jbHVkZXMiLCJzaGlwcGluZ0FkZHJlc3MiLCJsaW5lMSIsImNpdHkiLCJwb3N0YWxfY29kZSIsImNvdW50cnkiLCJzaGlwcGluZ09wdGlvbiIsInZhbGlkT3B0aW9ucyIsIm1hcCIsIm9wdGlvbiIsImlkIiwiam9pbiIsImlzVmFsaWQiLCJjcmVhdGVFcnJvclJlc3BvbnNlIiwibWVzc2FnZSIsInN0YXR1cyIsImRldGFpbHMiLCJjb2RlIiwiZXJyb3JSZXNwb25zZSIsImVycm9yIiwidGltZXN0YW1wIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwiY29uc29sZSIsImpzb24iLCJnZW5lcmF0ZU9yZGVySWQiLCJub3ciLCJ0b1N0cmluZyIsInJhbmRvbSIsIk1hdGgiLCJzdWJzdHIiLCJ0b1VwcGVyQ2FzZSIsImJ1aWxkU2hpcHBpbmdPcHRpb25zIiwic3VidG90YWwiLCJzZWxlY3RlZE9wdGlvbiIsImFtb3VudCIsInByaWNlIiwic2hpcHBpbmdfcmF0ZV9kYXRhIiwidHlwZSIsImZpeGVkX2Ftb3VudCIsImN1cnJlbmN5IiwiZGlzcGxheV9uYW1lIiwibmFtZSIsImRlbGl2ZXJ5X2VzdGltYXRlIiwibWluaW11bSIsInVuaXQiLCJ2YWx1ZSIsImVzdGltYXRlZERheXMiLCJtaW4iLCJtYXhpbXVtIiwibWF4IiwiUE9TVCIsInJlcXVlc3QiLCJzdGFydFRpbWUiLCJyZXF1ZXN0RGF0YSIsInBhcnNlRXJyb3IiLCJFcnJvciIsInJlcXVlc3RWYWxpZGF0aW9uIiwiY2FydFZhbGlkYXRpb24iLCJjYXJ0U3VtbWFyeSIsImxpbmVJdGVtcyIsIm9yZGVySWQiLCJzdHJpcGUiLCJtZXRhZGF0YSIsIm9yZGVyVHlwZSIsIml0ZW1Db3VudCIsInNoaXBwaW5nIiwidGF4IiwidG90YWwiLCJuZXdzbGV0dGVyIiwiY3JlYXRlZEF0IiwiY3VzdG9tZXJOYW1lIiwiY3VzdG9tZXJQaG9uZSIsInNoaXBwaW5nT3B0aW9ucyIsInNlc3Npb24iLCJjaGVja291dCIsInNlc3Npb25zIiwiY3JlYXRlIiwicGF5bWVudF9tZXRob2RfdHlwZXMiLCJtb2RlIiwibGluZV9pdGVtcyIsInN1Y2Nlc3NfdXJsIiwibmV4dFVybCIsIm9yaWdpbiIsImNhbmNlbF91cmwiLCJjdXN0b21lcl9lbWFpbCIsImJpbGxpbmdfYWRkcmVzc19jb2xsZWN0aW9uIiwibG9jYWxlIiwiY3VzdG9tZXJFbWFpbCIsImxvZyIsInNlc3Npb25JZCIsInByb2Nlc3NpbmdUaW1lIiwicmVzcG9uc2UiLCJoZWFkZXJzIiwic3RyaXBlRXJyb3IiLCJlcnJvck1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/create-checkout-session/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/cart.ts":
/*!*************************!*\
  !*** ./src/lib/cart.ts ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CART_CONSTANTS: () => (/* binding */ CART_CONSTANTS),\n/* harmony export */   SHIPPING_OPTIONS: () => (/* binding */ SHIPPING_OPTIONS),\n/* harmony export */   addToCart: () => (/* binding */ addToCart),\n/* harmony export */   calculateCartSummary: () => (/* binding */ calculateCartSummary),\n/* harmony export */   calculateShipping: () => (/* binding */ calculateShipping),\n/* harmony export */   calculateSubtotal: () => (/* binding */ calculateSubtotal),\n/* harmony export */   calculateTax: () => (/* binding */ calculateTax),\n/* harmony export */   clearCart: () => (/* binding */ clearCart),\n/* harmony export */   convertToStripeLineItems: () => (/* binding */ convertToStripeLineItems),\n/* harmony export */   findCartItem: () => (/* binding */ findCartItem),\n/* harmony export */   formatPrice: () => (/* binding */ formatPrice),\n/* harmony export */   getCartItemCount: () => (/* binding */ getCartItemCount),\n/* harmony export */   getFreeShippingRemaining: () => (/* binding */ getFreeShippingRemaining),\n/* harmony export */   getUniqueProductCount: () => (/* binding */ getUniqueProductCount),\n/* harmony export */   isCartEmpty: () => (/* binding */ isCartEmpty),\n/* harmony export */   isFreeShippingEligible: () => (/* binding */ isFreeShippingEligible),\n/* harmony export */   removeFromCart: () => (/* binding */ removeFromCart),\n/* harmony export */   updateCartItemQuantity: () => (/* binding */ updateCartItemQuantity),\n/* harmony export */   validateCart: () => (/* binding */ validateCart),\n/* harmony export */   validateCartForCheckout: () => (/* binding */ validateCartForCheckout),\n/* harmony export */   validateCartItem: () => (/* binding */ validateCartItem)\n/* harmony export */ });\n/**\n * Cart data management utilities for My Tech Glasses\n * Handles cart items, validation, and price calculations\n */ // ============================================================================\n// TYPES AND INTERFACES\n// ============================================================================\n// ============================================================================\n// CONSTANTS\n// ============================================================================\nconst CART_CONSTANTS = {\n    // Shipping\n    FREE_SHIPPING_THRESHOLD: 2000,\n    DEFAULT_SHIPPING_COST: 15,\n    EXPRESS_SHIPPING_COST: 25,\n    // Tax\n    DEFAULT_TAX_RATE: 0.23,\n    // Limits\n    MAX_QUANTITY_PER_ITEM: 10,\n    MAX_ITEMS_IN_CART: 50,\n    // Currency\n    CURRENCY: \"PLN\",\n    CURRENCY_SYMBOL: \"zł\"\n};\nconst SHIPPING_OPTIONS = [\n    {\n        id: \"standard\",\n        name: \"Dostawa standardowa\",\n        price: CART_CONSTANTS.DEFAULT_SHIPPING_COST,\n        estimatedDays: {\n            min: 3,\n            max: 5\n        },\n        description: \"3-5 dni roboczych\"\n    },\n    {\n        id: \"express\",\n        name: \"Dostawa ekspresowa\",\n        price: CART_CONSTANTS.EXPRESS_SHIPPING_COST,\n        estimatedDays: {\n            min: 1,\n            max: 2\n        },\n        description: \"1-2 dni robocze\"\n    }\n];\n// ============================================================================\n// VALIDATION FUNCTIONS\n// ============================================================================\n/**\n * Validates a single cart item\n */ const validateCartItem = (item)=>{\n    const errors = [];\n    // Required fields\n    if (!item.id || typeof item.id !== \"number\") {\n        errors.push(\"Item ID is required and must be a number\");\n    }\n    if (!item.productId || typeof item.productId !== \"string\") {\n        errors.push(\"Product ID is required and must be a string\");\n    }\n    if (!item.name || typeof item.name !== \"string\" || item.name.trim().length === 0) {\n        errors.push(\"Item name is required and cannot be empty\");\n    }\n    if (!item.price || typeof item.price !== \"number\" || item.price <= 0) {\n        errors.push(\"Item price is required and must be a positive number\");\n    }\n    if (!item.quantity || typeof item.quantity !== \"number\" || item.quantity <= 0) {\n        errors.push(\"Item quantity is required and must be a positive number\");\n    }\n    // Business rules\n    if (item.quantity && item.quantity > CART_CONSTANTS.MAX_QUANTITY_PER_ITEM) {\n        errors.push(`Quantity cannot exceed ${CART_CONSTANTS.MAX_QUANTITY_PER_ITEM} per item`);\n    }\n    if (item.price && item.price > 100000) {\n        errors.push(\"Item price seems unreasonably high\");\n    }\n    return {\n        isValid: errors.length === 0,\n        errors\n    };\n};\n/**\n * Validates an entire cart\n */ const validateCart = (items)=>{\n    const errors = [];\n    // Check cart size\n    if (items.length > CART_CONSTANTS.MAX_ITEMS_IN_CART) {\n        errors.push(`Cart cannot contain more than ${CART_CONSTANTS.MAX_ITEMS_IN_CART} items`);\n    }\n    // Validate each item\n    items.forEach((item, index)=>{\n        const itemValidation = validateCartItem(item);\n        if (!itemValidation.isValid) {\n            errors.push(`Item ${index + 1}: ${itemValidation.errors.join(\", \")}`);\n        }\n    });\n    // Check for duplicate items (same productId and color)\n    const duplicates = items.filter((item, index)=>items.findIndex((other)=>other.productId === item.productId && other.color === item.color) !== index);\n    if (duplicates.length > 0) {\n        errors.push(\"Cart contains duplicate items (same product and color)\");\n    }\n    return {\n        isValid: errors.length === 0,\n        errors\n    };\n};\n// ============================================================================\n// PRICE CALCULATION FUNCTIONS\n// ============================================================================\n/**\n * Calculates subtotal for cart items\n */ const calculateSubtotal = (items)=>{\n    return items.reduce((sum, item)=>{\n        const itemTotal = item.price * item.quantity;\n        return sum + itemTotal;\n    }, 0);\n};\n/**\n * Calculates shipping cost based on subtotal and shipping option\n */ const calculateShipping = (subtotal, shippingOptionId = \"standard\")=>{\n    // Free shipping threshold\n    if (subtotal >= CART_CONSTANTS.FREE_SHIPPING_THRESHOLD) {\n        return 0;\n    }\n    // Find shipping option\n    const shippingOption = SHIPPING_OPTIONS.find((option)=>option.id === shippingOptionId);\n    if (!shippingOption) {\n        console.warn(`Unknown shipping option: ${shippingOptionId}, using standard`);\n        return CART_CONSTANTS.DEFAULT_SHIPPING_COST;\n    }\n    return shippingOption.price;\n};\n/**\n * Calculates tax amount\n */ const calculateTax = (subtotal, taxRate = CART_CONSTANTS.DEFAULT_TAX_RATE, taxIncluded = false)=>{\n    let taxAmount;\n    if (taxIncluded) {\n        // Tax is already included in prices, calculate the tax portion\n        taxAmount = subtotal - subtotal / (1 + taxRate);\n    } else {\n        // Tax is added on top of prices\n        taxAmount = subtotal * taxRate;\n    }\n    return {\n        rate: taxRate,\n        amount: Math.round(taxAmount * 100) / 100,\n        included: taxIncluded\n    };\n};\n/**\n * Calculates complete cart summary\n */ const calculateCartSummary = (items, shippingOptionId = \"standard\", taxRate = CART_CONSTANTS.DEFAULT_TAX_RATE, taxIncluded = false)=>{\n    const subtotal = calculateSubtotal(items);\n    const shipping = calculateShipping(subtotal, shippingOptionId);\n    const taxCalculation = calculateTax(subtotal, taxRate, taxIncluded);\n    const total = taxIncluded ? subtotal + shipping : subtotal + shipping + taxCalculation.amount;\n    const itemCount = items.reduce((count, item)=>count + item.quantity, 0);\n    return {\n        items,\n        subtotal,\n        shipping,\n        tax: taxCalculation.amount,\n        total: Math.round(total * 100) / 100,\n        currency: CART_CONSTANTS.CURRENCY,\n        itemCount\n    };\n};\n// ============================================================================\n// CART MANIPULATION FUNCTIONS\n// ============================================================================\n/**\n * Adds an item to the cart or updates quantity if it already exists\n */ const addToCart = (currentItems, newItem, generateId = ()=>Date.now())=>{\n    // Check if item already exists (same productId and color)\n    const existingItemIndex = currentItems.findIndex((item)=>item.productId === newItem.productId && item.color === newItem.color);\n    if (existingItemIndex >= 0) {\n        // Update existing item quantity\n        const updatedItems = [\n            ...currentItems\n        ];\n        const existingItem = updatedItems[existingItemIndex];\n        const newQuantity = existingItem.quantity + newItem.quantity;\n        // Check quantity limit\n        if (newQuantity > CART_CONSTANTS.MAX_QUANTITY_PER_ITEM) {\n            throw new Error(`Cannot add more items. Maximum ${CART_CONSTANTS.MAX_QUANTITY_PER_ITEM} per product.`);\n        }\n        updatedItems[existingItemIndex] = {\n            ...existingItem,\n            quantity: newQuantity\n        };\n        return updatedItems;\n    } else {\n        // Add new item\n        const itemWithId = {\n            ...newItem,\n            id: generateId()\n        };\n        // Validate the new item\n        const validation = validateCartItem(itemWithId);\n        if (!validation.isValid) {\n            throw new Error(`Invalid item: ${validation.errors.join(\", \")}`);\n        }\n        return [\n            ...currentItems,\n            itemWithId\n        ];\n    }\n};\n/**\n * Updates the quantity of an item in the cart\n */ const updateCartItemQuantity = (items, itemId, newQuantity)=>{\n    if (newQuantity < 1) {\n        throw new Error(\"Quantity must be at least 1\");\n    }\n    if (newQuantity > CART_CONSTANTS.MAX_QUANTITY_PER_ITEM) {\n        throw new Error(`Quantity cannot exceed ${CART_CONSTANTS.MAX_QUANTITY_PER_ITEM}`);\n    }\n    return items.map((item)=>item.id === itemId ? {\n            ...item,\n            quantity: newQuantity\n        } : item);\n};\n/**\n * Removes an item from the cart\n */ const removeFromCart = (items, itemId)=>{\n    return items.filter((item)=>item.id !== itemId);\n};\n/**\n * Clears all items from the cart\n */ const clearCart = ()=>{\n    return [];\n};\n// ============================================================================\n// UTILITY FUNCTIONS\n// ============================================================================\n/**\n * Formats price with currency symbol\n */ const formatPrice = (price, currency = CART_CONSTANTS.CURRENCY)=>{\n    const symbol = currency === \"PLN\" ? CART_CONSTANTS.CURRENCY_SYMBOL : currency;\n    return `${price} ${symbol}`;\n};\n/**\n * Gets cart item count (total quantity of all items)\n */ const getCartItemCount = (items)=>{\n    return items.reduce((count, item)=>count + item.quantity, 0);\n};\n/**\n * Gets unique product count (number of different products)\n */ const getUniqueProductCount = (items)=>{\n    return items.length;\n};\n/**\n * Checks if cart is empty\n */ const isCartEmpty = (items)=>{\n    return items.length === 0;\n};\n/**\n * Finds an item in the cart by ID\n */ const findCartItem = (items, itemId)=>{\n    return items.find((item)=>item.id === itemId);\n};\n/**\n * Checks if free shipping threshold is met\n */ const isFreeShippingEligible = (subtotal)=>{\n    return subtotal >= CART_CONSTANTS.FREE_SHIPPING_THRESHOLD;\n};\n/**\n * Calculates how much more is needed for free shipping\n */ const getFreeShippingRemaining = (subtotal)=>{\n    if (isFreeShippingEligible(subtotal)) {\n        return 0;\n    }\n    return CART_CONSTANTS.FREE_SHIPPING_THRESHOLD - subtotal;\n};\n// ============================================================================\n// STRIPE INTEGRATION HELPERS\n// ============================================================================\n/**\n * Converts cart items to Stripe line items format\n */ const convertToStripeLineItems = (items)=>{\n    return items.map((item)=>({\n            price_data: {\n                currency: \"pln\",\n                product_data: {\n                    name: item.name,\n                    description: item.description || `Inteligentne okulary ${item.name}`,\n                    images: item.image ? [\n                        item.image\n                    ] : [],\n                    metadata: {\n                        productId: item.productId,\n                        color: item.color || \"\",\n                        ...item.metadata\n                    }\n                },\n                unit_amount: Math.round(item.price * 100)\n            },\n            quantity: item.quantity\n        }));\n};\n/**\n * Validates cart for Stripe checkout\n */ const validateCartForCheckout = (items)=>{\n    const errors = [];\n    // Basic cart validation\n    const cartValidation = validateCart(items);\n    if (!cartValidation.isValid) {\n        errors.push(...cartValidation.errors);\n    }\n    // Stripe-specific validations\n    if (items.length === 0) {\n        errors.push(\"Cart cannot be empty for checkout\");\n    }\n    // Check for minimum order value (if any)\n    const subtotal = calculateSubtotal(items);\n    if (subtotal < 1) {\n        errors.push(\"Order total must be at least 1 PLN\");\n    }\n    // Check for maximum order value (Stripe limit)\n    if (subtotal > 999999) {\n        errors.push(\"Order total cannot exceed 999,999 PLN\");\n    }\n    return {\n        isValid: errors.length === 0,\n        errors\n    };\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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eEIsTUFBTWlGLGlCQUFpQjFFLGFBQWFDO0lBQ3BDLElBQUksQ0FBQ3lFLGVBQWUzRSxPQUFPLEVBQUU7UUFDM0JOLE9BQU9DLElBQUksSUFBSWdGLGVBQWVqRixNQUFNO0lBQ3RDO0lBRUEsOEJBQThCO0lBQzlCLElBQUlRLE1BQU1KLE1BQU0sS0FBSyxHQUFHO1FBQ3RCSixPQUFPQyxJQUFJLENBQUM7SUFDZDtJQUVBLHlDQUF5QztJQUN6QyxNQUFNc0IsV0FBV0wsa0JBQWtCVjtJQUNuQyxJQUFJZSxXQUFXLEdBQUc7UUFDaEJ2QixPQUFPQyxJQUFJLENBQUM7SUFDZDtJQUVBLCtDQUErQztJQUMvQyxJQUFJc0IsV0FBVyxRQUFRO1FBQ3JCdkIsT0FBT0MsSUFBSSxDQUFDO0lBQ2Q7SUFFQSxPQUFPO1FBQ0xLLFNBQVNOLE9BQU9JLE1BQU0sS0FBSztRQUMzQko7SUFDRjtBQUNGLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS10ZWNoLWdsYXNzZXMvLi9zcmMvbGliL2NhcnQudHM/YzM5NSJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENhcnQgZGF0YSBtYW5hZ2VtZW50IHV0aWxpdGllcyBmb3IgTXkgVGVjaCBHbGFzc2VzXG4gKiBIYW5kbGVzIGNhcnQgaXRlbXMsIHZhbGlkYXRpb24sIGFuZCBwcmljZSBjYWxjdWxhdGlvbnNcbiAqL1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBUWVBFUyBBTkQgSU5URVJGQUNFU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgaW50ZXJmYWNlIENhcnRJdGVtIHtcbiAgaWQ6IG51bWJlclxuICBwcm9kdWN0SWQ6IHN0cmluZ1xuICBuYW1lOiBzdHJpbmdcbiAgcHJpY2U6IG51bWJlciAvLyBQcmljZSBpbiBQTE4gKFBvbGlzaCBaxYJvdHkpXG4gIHF1YW50aXR5OiBudW1iZXJcbiAgY29sb3I/OiBzdHJpbmdcbiAgZW1vamk/OiBzdHJpbmdcbiAgZGVzY3JpcHRpb24/OiBzdHJpbmdcbiAgaW1hZ2U/OiBzdHJpbmdcbiAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQ2FydFN1bW1hcnkge1xuICBpdGVtczogQ2FydEl0ZW1bXVxuICBzdWJ0b3RhbDogbnVtYmVyXG4gIHNoaXBwaW5nOiBudW1iZXJcbiAgdGF4OiBudW1iZXJcbiAgdG90YWw6IG51bWJlclxuICBjdXJyZW5jeTogJ1BMTidcbiAgaXRlbUNvdW50OiBudW1iZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBTaGlwcGluZ09wdGlvbiB7XG4gIGlkOiBzdHJpbmdcbiAgbmFtZTogc3RyaW5nXG4gIHByaWNlOiBudW1iZXJcbiAgZXN0aW1hdGVkRGF5czoge1xuICAgIG1pbjogbnVtYmVyXG4gICAgbWF4OiBudW1iZXJcbiAgfVxuICBkZXNjcmlwdGlvbjogc3RyaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgVGF4Q2FsY3VsYXRpb24ge1xuICByYXRlOiBudW1iZXIgLy8gVGF4IHJhdGUgKGUuZy4sIDAuMjMgZm9yIDIzJSBWQVQpXG4gIGFtb3VudDogbnVtYmVyIC8vIFRheCBhbW91bnQgaW4gUExOXG4gIGluY2x1ZGVkOiBib29sZWFuIC8vIFdoZXRoZXIgdGF4IGlzIGluY2x1ZGVkIGluIGl0ZW0gcHJpY2VzXG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIENPTlNUQU5UU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgY29uc3QgQ0FSVF9DT05TVEFOVFMgPSB7XG4gIC8vIFNoaXBwaW5nXG4gIEZSRUVfU0hJUFBJTkdfVEhSRVNIT0xEOiAyMDAwLCAvLyBGcmVlIHNoaXBwaW5nIG92ZXIgMjAwMCBQTE5cbiAgREVGQVVMVF9TSElQUElOR19DT1NUOiAxNSwgLy8gU3RhbmRhcmQgc2hpcHBpbmcgY29zdCBpbiBQTE5cbiAgRVhQUkVTU19TSElQUElOR19DT1NUOiAyNSwgLy8gRXhwcmVzcyBzaGlwcGluZyBjb3N0IGluIFBMTlxuICBcbiAgLy8gVGF4XG4gIERFRkFVTFRfVEFYX1JBVEU6IDAuMjMsIC8vIDIzJSBWQVQgaW4gUG9sYW5kXG4gIFxuICAvLyBMaW1pdHNcbiAgTUFYX1FVQU5USVRZX1BFUl9JVEVNOiAxMCxcbiAgTUFYX0lURU1TX0lOX0NBUlQ6IDUwLFxuICBcbiAgLy8gQ3VycmVuY3lcbiAgQ1VSUkVOQ1k6ICdQTE4nIGFzIGNvbnN0LFxuICBDVVJSRU5DWV9TWU1CT0w6ICd6xYInLFxufSBhcyBjb25zdFxuXG5leHBvcnQgY29uc3QgU0hJUFBJTkdfT1BUSU9OUzogU2hpcHBpbmdPcHRpb25bXSA9IFtcbiAge1xuICAgIGlkOiAnc3RhbmRhcmQnLFxuICAgIG5hbWU6ICdEb3N0YXdhIHN0YW5kYXJkb3dhJyxcbiAgICBwcmljZTogQ0FSVF9DT05TVEFOVFMuREVGQVVMVF9TSElQUElOR19DT1NULFxuICAgIGVzdGltYXRlZERheXM6IHsgbWluOiAzLCBtYXg6IDUgfSxcbiAgICBkZXNjcmlwdGlvbjogJzMtNSBkbmkgcm9ib2N6eWNoJ1xuICB9LFxuICB7XG4gICAgaWQ6ICdleHByZXNzJyxcbiAgICBuYW1lOiAnRG9zdGF3YSBla3NwcmVzb3dhJyxcbiAgICBwcmljZTogQ0FSVF9DT05TVEFOVFMuRVhQUkVTU19TSElQUElOR19DT1NULFxuICAgIGVzdGltYXRlZERheXM6IHsgbWluOiAxLCBtYXg6IDIgfSxcbiAgICBkZXNjcmlwdGlvbjogJzEtMiBkbmkgcm9ib2N6ZSdcbiAgfVxuXVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBWQUxJREFUSU9OIEZVTkNUSU9OU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIFZhbGlkYXRlcyBhIHNpbmdsZSBjYXJ0IGl0ZW1cbiAqL1xuZXhwb3J0IGNvbnN0IHZhbGlkYXRlQ2FydEl0ZW0gPSAoaXRlbTogUGFydGlhbDxDYXJ0SXRlbT4pOiB7IGlzVmFsaWQ6IGJvb2xlYW47IGVycm9yczogc3RyaW5nW10gfSA9PiB7XG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXVxuXG4gIC8vIFJlcXVpcmVkIGZpZWxkc1xuICBpZiAoIWl0ZW0uaWQgfHwgdHlwZW9mIGl0ZW0uaWQgIT09ICdudW1iZXInKSB7XG4gICAgZXJyb3JzLnB1c2goJ0l0ZW0gSUQgaXMgcmVxdWlyZWQgYW5kIG11c3QgYmUgYSBudW1iZXInKVxuICB9XG5cbiAgaWYgKCFpdGVtLnByb2R1Y3RJZCB8fCB0eXBlb2YgaXRlbS5wcm9kdWN0SWQgIT09ICdzdHJpbmcnKSB7XG4gICAgZXJyb3JzLnB1c2goJ1Byb2R1Y3QgSUQgaXMgcmVxdWlyZWQgYW5kIG11c3QgYmUgYSBzdHJpbmcnKVxuICB9XG5cbiAgaWYgKCFpdGVtLm5hbWUgfHwgdHlwZW9mIGl0ZW0ubmFtZSAhPT0gJ3N0cmluZycgfHwgaXRlbS5uYW1lLnRyaW0oKS5sZW5ndGggPT09IDApIHtcbiAgICBlcnJvcnMucHVzaCgnSXRlbSBuYW1lIGlzIHJlcXVpcmVkIGFuZCBjYW5ub3QgYmUgZW1wdHknKVxuICB9XG5cbiAgaWYgKCFpdGVtLnByaWNlIHx8IHR5cGVvZiBpdGVtLnByaWNlICE9PSAnbnVtYmVyJyB8fCBpdGVtLnByaWNlIDw9IDApIHtcbiAgICBlcnJvcnMucHVzaCgnSXRlbSBwcmljZSBpcyByZXF1aXJlZCBhbmQgbXVzdCBiZSBhIHBvc2l0aXZlIG51bWJlcicpXG4gIH1cblxuICBpZiAoIWl0ZW0ucXVhbnRpdHkgfHwgdHlwZW9mIGl0ZW0ucXVhbnRpdHkgIT09ICdudW1iZXInIHx8IGl0ZW0ucXVhbnRpdHkgPD0gMCkge1xuICAgIGVycm9ycy5wdXNoKCdJdGVtIHF1YW50aXR5IGlzIHJlcXVpcmVkIGFuZCBtdXN0IGJlIGEgcG9zaXRpdmUgbnVtYmVyJylcbiAgfVxuXG4gIC8vIEJ1c2luZXNzIHJ1bGVzXG4gIGlmIChpdGVtLnF1YW50aXR5ICYmIGl0ZW0ucXVhbnRpdHkgPiBDQVJUX0NPTlNUQU5UUy5NQVhfUVVBTlRJVFlfUEVSX0lURU0pIHtcbiAgICBlcnJvcnMucHVzaChgUXVhbnRpdHkgY2Fubm90IGV4Y2VlZCAke0NBUlRfQ09OU1RBTlRTLk1BWF9RVUFOVElUWV9QRVJfSVRFTX0gcGVyIGl0ZW1gKVxuICB9XG5cbiAgaWYgKGl0ZW0ucHJpY2UgJiYgaXRlbS5wcmljZSA+IDEwMDAwMCkge1xuICAgIGVycm9ycy5wdXNoKCdJdGVtIHByaWNlIHNlZW1zIHVucmVhc29uYWJseSBoaWdoJylcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgaXNWYWxpZDogZXJyb3JzLmxlbmd0aCA9PT0gMCxcbiAgICBlcnJvcnNcbiAgfVxufVxuXG4vKipcbiAqIFZhbGlkYXRlcyBhbiBlbnRpcmUgY2FydFxuICovXG5leHBvcnQgY29uc3QgdmFsaWRhdGVDYXJ0ID0gKGl0ZW1zOiBDYXJ0SXRlbVtdKTogeyBpc1ZhbGlkOiBib29sZWFuOyBlcnJvcnM6IHN0cmluZ1tdIH0gPT4ge1xuICBjb25zdCBlcnJvcnM6IHN0cmluZ1tdID0gW11cblxuICAvLyBDaGVjayBjYXJ0IHNpemVcbiAgaWYgKGl0ZW1zLmxlbmd0aCA+IENBUlRfQ09OU1RBTlRTLk1BWF9JVEVNU19JTl9DQVJUKSB7XG4gICAgZXJyb3JzLnB1c2goYENhcnQgY2Fubm90IGNvbnRhaW4gbW9yZSB0aGFuICR7Q0FSVF9DT05TVEFOVFMuTUFYX0lURU1TX0lOX0NBUlR9IGl0ZW1zYClcbiAgfVxuXG4gIC8vIFZhbGlkYXRlIGVhY2ggaXRlbVxuICBpdGVtcy5mb3JFYWNoKChpdGVtLCBpbmRleCkgPT4ge1xuICAgIGNvbnN0IGl0ZW1WYWxpZGF0aW9uID0gdmFsaWRhdGVDYXJ0SXRlbShpdGVtKVxuICAgIGlmICghaXRlbVZhbGlkYXRpb24uaXNWYWxpZCkge1xuICAgICAgZXJyb3JzLnB1c2goYEl0ZW0gJHtpbmRleCArIDF9OiAke2l0ZW1WYWxpZGF0aW9uLmVycm9ycy5qb2luKCcsICcpfWApXG4gICAgfVxuICB9KVxuXG4gIC8vIENoZWNrIGZvciBkdXBsaWNhdGUgaXRlbXMgKHNhbWUgcHJvZHVjdElkIGFuZCBjb2xvcilcbiAgY29uc3QgZHVwbGljYXRlcyA9IGl0ZW1zLmZpbHRlcigoaXRlbSwgaW5kZXgpID0+IFxuICAgIGl0ZW1zLmZpbmRJbmRleChvdGhlciA9PiBcbiAgICAgIG90aGVyLnByb2R1Y3RJZCA9PT0gaXRlbS5wcm9kdWN0SWQgJiYgXG4gICAgICBvdGhlci5jb2xvciA9PT0gaXRlbS5jb2xvclxuICAgICkgIT09IGluZGV4XG4gIClcblxuICBpZiAoZHVwbGljYXRlcy5sZW5ndGggPiAwKSB7XG4gICAgZXJyb3JzLnB1c2goJ0NhcnQgY29udGFpbnMgZHVwbGljYXRlIGl0ZW1zIChzYW1lIHByb2R1Y3QgYW5kIGNvbG9yKScpXG4gIH1cblxuICByZXR1cm4ge1xuICAgIGlzVmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgZXJyb3JzXG4gIH1cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gUFJJQ0UgQ0FMQ1VMQVRJT04gRlVOQ1RJT05TXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogQ2FsY3VsYXRlcyBzdWJ0b3RhbCBmb3IgY2FydCBpdGVtc1xuICovXG5leHBvcnQgY29uc3QgY2FsY3VsYXRlU3VidG90YWwgPSAoaXRlbXM6IENhcnRJdGVtW10pOiBudW1iZXIgPT4ge1xuICByZXR1cm4gaXRlbXMucmVkdWNlKChzdW0sIGl0ZW0pID0+IHtcbiAgICBjb25zdCBpdGVtVG90YWwgPSBpdGVtLnByaWNlICogaXRlbS5xdWFudGl0eVxuICAgIHJldHVybiBzdW0gKyBpdGVtVG90YWxcbiAgfSwgMClcbn1cblxuLyoqXG4gKiBDYWxjdWxhdGVzIHNoaXBwaW5nIGNvc3QgYmFzZWQgb24gc3VidG90YWwgYW5kIHNoaXBwaW5nIG9wdGlvblxuICovXG5leHBvcnQgY29uc3QgY2FsY3VsYXRlU2hpcHBpbmcgPSAoXG4gIHN1YnRvdGFsOiBudW1iZXIsIFxuICBzaGlwcGluZ09wdGlvbklkOiBzdHJpbmcgPSAnc3RhbmRhcmQnXG4pOiBudW1iZXIgPT4ge1xuICAvLyBGcmVlIHNoaXBwaW5nIHRocmVzaG9sZFxuICBpZiAoc3VidG90YWwgPj0gQ0FSVF9DT05TVEFOVFMuRlJFRV9TSElQUElOR19USFJFU0hPTEQpIHtcbiAgICByZXR1cm4gMFxuICB9XG5cbiAgLy8gRmluZCBzaGlwcGluZyBvcHRpb25cbiAgY29uc3Qgc2hpcHBpbmdPcHRpb24gPSBTSElQUElOR19PUFRJT05TLmZpbmQob3B0aW9uID0+IG9wdGlvbi5pZCA9PT0gc2hpcHBpbmdPcHRpb25JZClcbiAgXG4gIGlmICghc2hpcHBpbmdPcHRpb24pIHtcbiAgICBjb25zb2xlLndhcm4oYFVua25vd24gc2hpcHBpbmcgb3B0aW9uOiAke3NoaXBwaW5nT3B0aW9uSWR9LCB1c2luZyBzdGFuZGFyZGApXG4gICAgcmV0dXJuIENBUlRfQ09OU1RBTlRTLkRFRkFVTFRfU0hJUFBJTkdfQ09TVFxuICB9XG5cbiAgcmV0dXJuIHNoaXBwaW5nT3B0aW9uLnByaWNlXG59XG5cbi8qKlxuICogQ2FsY3VsYXRlcyB0YXggYW1vdW50XG4gKi9cbmV4cG9ydCBjb25zdCBjYWxjdWxhdGVUYXggPSAoXG4gIHN1YnRvdGFsOiBudW1iZXIsIFxuICB0YXhSYXRlOiBudW1iZXIgPSBDQVJUX0NPTlNUQU5UUy5ERUZBVUxUX1RBWF9SQVRFLFxuICB0YXhJbmNsdWRlZDogYm9vbGVhbiA9IGZhbHNlXG4pOiBUYXhDYWxjdWxhdGlvbiA9PiB7XG4gIGxldCB0YXhBbW91bnQ6IG51bWJlclxuXG4gIGlmICh0YXhJbmNsdWRlZCkge1xuICAgIC8vIFRheCBpcyBhbHJlYWR5IGluY2x1ZGVkIGluIHByaWNlcywgY2FsY3VsYXRlIHRoZSB0YXggcG9ydGlvblxuICAgIHRheEFtb3VudCA9IHN1YnRvdGFsIC0gKHN1YnRvdGFsIC8gKDEgKyB0YXhSYXRlKSlcbiAgfSBlbHNlIHtcbiAgICAvLyBUYXggaXMgYWRkZWQgb24gdG9wIG9mIHByaWNlc1xuICAgIHRheEFtb3VudCA9IHN1YnRvdGFsICogdGF4UmF0ZVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICByYXRlOiB0YXhSYXRlLFxuICAgIGFtb3VudDogTWF0aC5yb3VuZCh0YXhBbW91bnQgKiAxMDApIC8gMTAwLCAvLyBSb3VuZCB0byAyIGRlY2ltYWwgcGxhY2VzXG4gICAgaW5jbHVkZWQ6IHRheEluY2x1ZGVkXG4gIH1cbn1cblxuLyoqXG4gKiBDYWxjdWxhdGVzIGNvbXBsZXRlIGNhcnQgc3VtbWFyeVxuICovXG5leHBvcnQgY29uc3QgY2FsY3VsYXRlQ2FydFN1bW1hcnkgPSAoXG4gIGl0ZW1zOiBDYXJ0SXRlbVtdLFxuICBzaGlwcGluZ09wdGlvbklkOiBzdHJpbmcgPSAnc3RhbmRhcmQnLFxuICB0YXhSYXRlOiBudW1iZXIgPSBDQVJUX0NPTlNUQU5UUy5ERUZBVUxUX1RBWF9SQVRFLFxuICB0YXhJbmNsdWRlZDogYm9vbGVhbiA9IGZhbHNlXG4pOiBDYXJ0U3VtbWFyeSA9PiB7XG4gIGNvbnN0IHN1YnRvdGFsID0gY2FsY3VsYXRlU3VidG90YWwoaXRlbXMpXG4gIGNvbnN0IHNoaXBwaW5nID0gY2FsY3VsYXRlU2hpcHBpbmcoc3VidG90YWwsIHNoaXBwaW5nT3B0aW9uSWQpXG4gIGNvbnN0IHRheENhbGN1bGF0aW9uID0gY2FsY3VsYXRlVGF4KHN1YnRvdGFsLCB0YXhSYXRlLCB0YXhJbmNsdWRlZClcbiAgXG4gIGNvbnN0IHRvdGFsID0gdGF4SW5jbHVkZWQgXG4gICAgPyBzdWJ0b3RhbCArIHNoaXBwaW5nIFxuICAgIDogc3VidG90YWwgKyBzaGlwcGluZyArIHRheENhbGN1bGF0aW9uLmFtb3VudFxuXG4gIGNvbnN0IGl0ZW1Db3VudCA9IGl0ZW1zLnJlZHVjZSgoY291bnQsIGl0ZW0pID0+IGNvdW50ICsgaXRlbS5xdWFudGl0eSwgMClcblxuICByZXR1cm4ge1xuICAgIGl0ZW1zLFxuICAgIHN1YnRvdGFsLFxuICAgIHNoaXBwaW5nLFxuICAgIHRheDogdGF4Q2FsY3VsYXRpb24uYW1vdW50LFxuICAgIHRvdGFsOiBNYXRoLnJvdW5kKHRvdGFsICogMTAwKSAvIDEwMCwgLy8gUm91bmQgdG8gMiBkZWNpbWFsIHBsYWNlc1xuICAgIGN1cnJlbmN5OiBDQVJUX0NPTlNUQU5UUy5DVVJSRU5DWSxcbiAgICBpdGVtQ291bnRcbiAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBDQVJUIE1BTklQVUxBVElPTiBGVU5DVElPTlNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBBZGRzIGFuIGl0ZW0gdG8gdGhlIGNhcnQgb3IgdXBkYXRlcyBxdWFudGl0eSBpZiBpdCBhbHJlYWR5IGV4aXN0c1xuICovXG5leHBvcnQgY29uc3QgYWRkVG9DYXJ0ID0gKFxuICBjdXJyZW50SXRlbXM6IENhcnRJdGVtW10sIFxuICBuZXdJdGVtOiBPbWl0PENhcnRJdGVtLCAnaWQnPixcbiAgZ2VuZXJhdGVJZDogKCkgPT4gbnVtYmVyID0gKCkgPT4gRGF0ZS5ub3coKVxuKTogQ2FydEl0ZW1bXSA9PiB7XG4gIC8vIENoZWNrIGlmIGl0ZW0gYWxyZWFkeSBleGlzdHMgKHNhbWUgcHJvZHVjdElkIGFuZCBjb2xvcilcbiAgY29uc3QgZXhpc3RpbmdJdGVtSW5kZXggPSBjdXJyZW50SXRlbXMuZmluZEluZGV4KFxuICAgIGl0ZW0gPT4gaXRlbS5wcm9kdWN0SWQgPT09IG5ld0l0ZW0ucHJvZHVjdElkICYmIGl0ZW0uY29sb3IgPT09IG5ld0l0ZW0uY29sb3JcbiAgKVxuXG4gIGlmIChleGlzdGluZ0l0ZW1JbmRleCA+PSAwKSB7XG4gICAgLy8gVXBkYXRlIGV4aXN0aW5nIGl0ZW0gcXVhbnRpdHlcbiAgICBjb25zdCB1cGRhdGVkSXRlbXMgPSBbLi4uY3VycmVudEl0ZW1zXVxuICAgIGNvbnN0IGV4aXN0aW5nSXRlbSA9IHVwZGF0ZWRJdGVtc1tleGlzdGluZ0l0ZW1JbmRleF1cbiAgICBjb25zdCBuZXdRdWFudGl0eSA9IGV4aXN0aW5nSXRlbS5xdWFudGl0eSArIG5ld0l0ZW0ucXVhbnRpdHlcblxuICAgIC8vIENoZWNrIHF1YW50aXR5IGxpbWl0XG4gICAgaWYgKG5ld1F1YW50aXR5ID4gQ0FSVF9DT05TVEFOVFMuTUFYX1FVQU5USVRZX1BFUl9JVEVNKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCBhZGQgbW9yZSBpdGVtcy4gTWF4aW11bSAke0NBUlRfQ09OU1RBTlRTLk1BWF9RVUFOVElUWV9QRVJfSVRFTX0gcGVyIHByb2R1Y3QuYClcbiAgICB9XG5cbiAgICB1cGRhdGVkSXRlbXNbZXhpc3RpbmdJdGVtSW5kZXhdID0ge1xuICAgICAgLi4uZXhpc3RpbmdJdGVtLFxuICAgICAgcXVhbnRpdHk6IG5ld1F1YW50aXR5XG4gICAgfVxuXG4gICAgcmV0dXJuIHVwZGF0ZWRJdGVtc1xuICB9IGVsc2Uge1xuICAgIC8vIEFkZCBuZXcgaXRlbVxuICAgIGNvbnN0IGl0ZW1XaXRoSWQ6IENhcnRJdGVtID0ge1xuICAgICAgLi4ubmV3SXRlbSxcbiAgICAgIGlkOiBnZW5lcmF0ZUlkKClcbiAgICB9XG5cbiAgICAvLyBWYWxpZGF0ZSB0aGUgbmV3IGl0ZW1cbiAgICBjb25zdCB2YWxpZGF0aW9uID0gdmFsaWRhdGVDYXJ0SXRlbShpdGVtV2l0aElkKVxuICAgIGlmICghdmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEludmFsaWQgaXRlbTogJHt2YWxpZGF0aW9uLmVycm9ycy5qb2luKCcsICcpfWApXG4gICAgfVxuXG4gICAgcmV0dXJuIFsuLi5jdXJyZW50SXRlbXMsIGl0ZW1XaXRoSWRdXG4gIH1cbn1cblxuLyoqXG4gKiBVcGRhdGVzIHRoZSBxdWFudGl0eSBvZiBhbiBpdGVtIGluIHRoZSBjYXJ0XG4gKi9cbmV4cG9ydCBjb25zdCB1cGRhdGVDYXJ0SXRlbVF1YW50aXR5ID0gKFxuICBpdGVtczogQ2FydEl0ZW1bXSwgXG4gIGl0ZW1JZDogbnVtYmVyLCBcbiAgbmV3UXVhbnRpdHk6IG51bWJlclxuKTogQ2FydEl0ZW1bXSA9PiB7XG4gIGlmIChuZXdRdWFudGl0eSA8IDEpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ1F1YW50aXR5IG11c3QgYmUgYXQgbGVhc3QgMScpXG4gIH1cblxuICBpZiAobmV3UXVhbnRpdHkgPiBDQVJUX0NPTlNUQU5UUy5NQVhfUVVBTlRJVFlfUEVSX0lURU0pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYFF1YW50aXR5IGNhbm5vdCBleGNlZWQgJHtDQVJUX0NPTlNUQU5UUy5NQVhfUVVBTlRJVFlfUEVSX0lURU19YClcbiAgfVxuXG4gIHJldHVybiBpdGVtcy5tYXAoaXRlbSA9PiBcbiAgICBpdGVtLmlkID09PSBpdGVtSWQgXG4gICAgICA/IHsgLi4uaXRlbSwgcXVhbnRpdHk6IG5ld1F1YW50aXR5IH1cbiAgICAgIDogaXRlbVxuICApXG59XG5cbi8qKlxuICogUmVtb3ZlcyBhbiBpdGVtIGZyb20gdGhlIGNhcnRcbiAqL1xuZXhwb3J0IGNvbnN0IHJlbW92ZUZyb21DYXJ0ID0gKGl0ZW1zOiBDYXJ0SXRlbVtdLCBpdGVtSWQ6IG51bWJlcik6IENhcnRJdGVtW10gPT4ge1xuICByZXR1cm4gaXRlbXMuZmlsdGVyKGl0ZW0gPT4gaXRlbS5pZCAhPT0gaXRlbUlkKVxufVxuXG4vKipcbiAqIENsZWFycyBhbGwgaXRlbXMgZnJvbSB0aGUgY2FydFxuICovXG5leHBvcnQgY29uc3QgY2xlYXJDYXJ0ID0gKCk6IENhcnRJdGVtW10gPT4ge1xuICByZXR1cm4gW11cbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gVVRJTElUWSBGVU5DVElPTlNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBGb3JtYXRzIHByaWNlIHdpdGggY3VycmVuY3kgc3ltYm9sXG4gKi9cbmV4cG9ydCBjb25zdCBmb3JtYXRQcmljZSA9IChwcmljZTogbnVtYmVyLCBjdXJyZW5jeTogc3RyaW5nID0gQ0FSVF9DT05TVEFOVFMuQ1VSUkVOQ1kpOiBzdHJpbmcgPT4ge1xuICBjb25zdCBzeW1ib2wgPSBjdXJyZW5jeSA9PT0gJ1BMTicgPyBDQVJUX0NPTlNUQU5UUy5DVVJSRU5DWV9TWU1CT0wgOiBjdXJyZW5jeVxuICByZXR1cm4gYCR7cHJpY2V9ICR7c3ltYm9sfWBcbn1cblxuLyoqXG4gKiBHZXRzIGNhcnQgaXRlbSBjb3VudCAodG90YWwgcXVhbnRpdHkgb2YgYWxsIGl0ZW1zKVxuICovXG5leHBvcnQgY29uc3QgZ2V0Q2FydEl0ZW1Db3VudCA9IChpdGVtczogQ2FydEl0ZW1bXSk6IG51bWJlciA9PiB7XG4gIHJldHVybiBpdGVtcy5yZWR1Y2UoKGNvdW50LCBpdGVtKSA9PiBjb3VudCArIGl0ZW0ucXVhbnRpdHksIDApXG59XG5cbi8qKlxuICogR2V0cyB1bmlxdWUgcHJvZHVjdCBjb3VudCAobnVtYmVyIG9mIGRpZmZlcmVudCBwcm9kdWN0cylcbiAqL1xuZXhwb3J0IGNvbnN0IGdldFVuaXF1ZVByb2R1Y3RDb3VudCA9IChpdGVtczogQ2FydEl0ZW1bXSk6IG51bWJlciA9PiB7XG4gIHJldHVybiBpdGVtcy5sZW5ndGhcbn1cblxuLyoqXG4gKiBDaGVja3MgaWYgY2FydCBpcyBlbXB0eVxuICovXG5leHBvcnQgY29uc3QgaXNDYXJ0RW1wdHkgPSAoaXRlbXM6IENhcnRJdGVtW10pOiBib29sZWFuID0+IHtcbiAgcmV0dXJuIGl0ZW1zLmxlbmd0aCA9PT0gMFxufVxuXG4vKipcbiAqIEZpbmRzIGFuIGl0ZW0gaW4gdGhlIGNhcnQgYnkgSURcbiAqL1xuZXhwb3J0IGNvbnN0IGZpbmRDYXJ0SXRlbSA9IChpdGVtczogQ2FydEl0ZW1bXSwgaXRlbUlkOiBudW1iZXIpOiBDYXJ0SXRlbSB8IHVuZGVmaW5lZCA9PiB7XG4gIHJldHVybiBpdGVtcy5maW5kKGl0ZW0gPT4gaXRlbS5pZCA9PT0gaXRlbUlkKVxufVxuXG4vKipcbiAqIENoZWNrcyBpZiBmcmVlIHNoaXBwaW5nIHRocmVzaG9sZCBpcyBtZXRcbiAqL1xuZXhwb3J0IGNvbnN0IGlzRnJlZVNoaXBwaW5nRWxpZ2libGUgPSAoc3VidG90YWw6IG51bWJlcik6IGJvb2xlYW4gPT4ge1xuICByZXR1cm4gc3VidG90YWwgPj0gQ0FSVF9DT05TVEFOVFMuRlJFRV9TSElQUElOR19USFJFU0hPTERcbn1cblxuLyoqXG4gKiBDYWxjdWxhdGVzIGhvdyBtdWNoIG1vcmUgaXMgbmVlZGVkIGZvciBmcmVlIHNoaXBwaW5nXG4gKi9cbmV4cG9ydCBjb25zdCBnZXRGcmVlU2hpcHBpbmdSZW1haW5pbmcgPSAoc3VidG90YWw6IG51bWJlcik6IG51bWJlciA9PiB7XG4gIGlmIChpc0ZyZWVTaGlwcGluZ0VsaWdpYmxlKHN1YnRvdGFsKSkge1xuICAgIHJldHVybiAwXG4gIH1cbiAgcmV0dXJuIENBUlRfQ09OU1RBTlRTLkZSRUVfU0hJUFBJTkdfVEhSRVNIT0xEIC0gc3VidG90YWxcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gU1RSSVBFIElOVEVHUkFUSU9OIEhFTFBFUlNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBDb252ZXJ0cyBjYXJ0IGl0ZW1zIHRvIFN0cmlwZSBsaW5lIGl0ZW1zIGZvcm1hdFxuICovXG5leHBvcnQgY29uc3QgY29udmVydFRvU3RyaXBlTGluZUl0ZW1zID0gKGl0ZW1zOiBDYXJ0SXRlbVtdKSA9PiB7XG4gIHJldHVybiBpdGVtcy5tYXAoaXRlbSA9PiAoe1xuICAgIHByaWNlX2RhdGE6IHtcbiAgICAgIGN1cnJlbmN5OiAncGxuJyxcbiAgICAgIHByb2R1Y3RfZGF0YToge1xuICAgICAgICBuYW1lOiBpdGVtLm5hbWUsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBpdGVtLmRlc2NyaXB0aW9uIHx8IGBJbnRlbGlnZW50bmUgb2t1bGFyeSAke2l0ZW0ubmFtZX1gLFxuICAgICAgICBpbWFnZXM6IGl0ZW0uaW1hZ2UgPyBbaXRlbS5pbWFnZV0gOiBbXSxcbiAgICAgICAgbWV0YWRhdGE6IHtcbiAgICAgICAgICBwcm9kdWN0SWQ6IGl0ZW0ucHJvZHVjdElkLFxuICAgICAgICAgIGNvbG9yOiBpdGVtLmNvbG9yIHx8ICcnLFxuICAgICAgICAgIC4uLml0ZW0ubWV0YWRhdGFcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHVuaXRfYW1vdW50OiBNYXRoLnJvdW5kKGl0ZW0ucHJpY2UgKiAxMDApLCAvLyBDb252ZXJ0IHRvIGdyb3N6ZSAoY2VudHMpXG4gICAgfSxcbiAgICBxdWFudGl0eTogaXRlbS5xdWFudGl0eSxcbiAgfSkpXG59XG5cbi8qKlxuICogVmFsaWRhdGVzIGNhcnQgZm9yIFN0cmlwZSBjaGVja291dFxuICovXG5leHBvcnQgY29uc3QgdmFsaWRhdGVDYXJ0Rm9yQ2hlY2tvdXQgPSAoaXRlbXM6IENhcnRJdGVtW10pOiB7IGlzVmFsaWQ6IGJvb2xlYW47IGVycm9yczogc3RyaW5nW10gfSA9PiB7XG4gIGNvbnN0IGVycm9yczogc3RyaW5nW10gPSBbXVxuXG4gIC8vIEJhc2ljIGNhcnQgdmFsaWRhdGlvblxuICBjb25zdCBjYXJ0VmFsaWRhdGlvbiA9IHZhbGlkYXRlQ2FydChpdGVtcylcbiAgaWYgKCFjYXJ0VmFsaWRhdGlvbi5pc1ZhbGlkKSB7XG4gICAgZXJyb3JzLnB1c2goLi4uY2FydFZhbGlkYXRpb24uZXJyb3JzKVxuICB9XG5cbiAgLy8gU3RyaXBlLXNwZWNpZmljIHZhbGlkYXRpb25zXG4gIGlmIChpdGVtcy5sZW5ndGggPT09IDApIHtcbiAgICBlcnJvcnMucHVzaCgnQ2FydCBjYW5ub3QgYmUgZW1wdHkgZm9yIGNoZWNrb3V0JylcbiAgfVxuXG4gIC8vIENoZWNrIGZvciBtaW5pbXVtIG9yZGVyIHZhbHVlIChpZiBhbnkpXG4gIGNvbnN0IHN1YnRvdGFsID0gY2FsY3VsYXRlU3VidG90YWwoaXRlbXMpXG4gIGlmIChzdWJ0b3RhbCA8IDEpIHtcbiAgICBlcnJvcnMucHVzaCgnT3JkZXIgdG90YWwgbXVzdCBiZSBhdCBsZWFzdCAxIFBMTicpXG4gIH1cblxuICAvLyBDaGVjayBmb3IgbWF4aW11bSBvcmRlciB2YWx1ZSAoU3RyaXBlIGxpbWl0KVxuICBpZiAoc3VidG90YWwgPiA5OTk5OTkpIHtcbiAgICBlcnJvcnMucHVzaCgnT3JkZXIgdG90YWwgY2Fubm90IGV4Y2VlZCA5OTksOTk5IFBMTicpXG4gIH1cblxuICByZXR1cm4ge1xuICAgIGlzVmFsaWQ6IGVycm9ycy5sZW5ndGggPT09IDAsXG4gICAgZXJyb3JzXG4gIH1cbn0iXSwibmFtZXMiOlsiQ0FSVF9DT05TVEFOVFMiLCJGUkVFX1NISVBQSU5HX1RIUkVTSE9MRCIsIkRFRkFVTFRfU0hJUFBJTkdfQ09TVCIsIkVYUFJFU1NfU0hJUFBJTkdfQ09TVCIsIkRFRkFVTFRfVEFYX1JBVEUiLCJNQVhfUVVBTlRJVFlfUEVSX0lURU0iLCJNQVhfSVRFTVNfSU5fQ0FSVCIsIkNVUlJFTkNZIiwiQ1VSUkVOQ1lfU1lNQk9MIiwiU0hJUFBJTkdfT1BUSU9OUyIsImlkIiwibmFtZSIsInByaWNlIiwiZXN0aW1hdGVkRGF5cyIsIm1pbiIsIm1heCIsImRlc2NyaXB0aW9uIiwidmFsaWRhdGVDYXJ0SXRlbSIsIml0ZW0iLCJlcnJvcnMiLCJwdXNoIiwicHJvZHVjdElkIiwidHJpbSIsImxlbmd0aCIsInF1YW50aXR5IiwiaXNWYWxpZCIsInZhbGlkYXRlQ2FydCIsIml0ZW1zIiwiZm9yRWFjaCIsImluZGV4IiwiaXRlbVZhbGlkYXRpb24iLCJqb2luIiwiZHVwbGljYXRlcyIsImZpbHRlciIsImZpbmRJbmRleCIsIm90aGVyIiwiY29sb3IiLCJjYWxjdWxhdGVTdWJ0b3RhbCIsInJlZHVjZSIsInN1bSIsIml0ZW1Ub3RhbCIsImNhbGN1bGF0ZVNoaXBwaW5nIiwic3VidG90YWwiLCJzaGlwcGluZ09wdGlvbklkIiwic2hpcHBpbmdPcHRpb24iLCJmaW5kIiwib3B0aW9uIiwiY29uc29sZSIsIndhcm4iLCJjYWxjdWxhdGVUYXgiLCJ0YXhSYXRlIiwidGF4SW5jbHVkZWQiLCJ0YXhBbW91bnQiLCJyYXRlIiwiYW1vdW50IiwiTWF0aCIsInJvdW5kIiwiaW5jbHVkZWQiLCJjYWxjdWxhdGVDYXJ0U3VtbWFyeSIsInNoaXBwaW5nIiwidGF4Q2FsY3VsYXRpb24iLCJ0b3RhbCIsIml0ZW1Db3VudCIsImNvdW50IiwidGF4IiwiY3VycmVuY3kiLCJhZGRUb0NhcnQiLCJjdXJyZW50SXRlbXMiLCJuZXdJdGVtIiwiZ2VuZXJhdGVJZCIsIkRhdGUiLCJub3ciLCJleGlzdGluZ0l0ZW1JbmRleCIsInVwZGF0ZWRJdGVtcyIsImV4aXN0aW5nSXRlbSIsIm5ld1F1YW50aXR5IiwiRXJyb3IiLCJpdGVtV2l0aElkIiwidmFsaWRhdGlvbiIsInVwZGF0ZUNhcnRJdGVtUXVhbnRpdHkiLCJpdGVtSWQiLCJtYXAiLCJyZW1vdmVGcm9tQ2FydCIsImNsZWFyQ2FydCIsImZvcm1hdFByaWNlIiwic3ltYm9sIiwiZ2V0Q2FydEl0ZW1Db3VudCIsImdldFVuaXF1ZVByb2R1Y3RDb3VudCIsImlzQ2FydEVtcHR5IiwiZmluZENhcnRJdGVtIiwiaXNGcmVlU2hpcHBpbmdFbGlnaWJsZSIsImdldEZyZWVTaGlwcGluZ1JlbWFpbmluZyIsImNvbnZlcnRUb1N0cmlwZUxpbmVJdGVtcyIsInByaWNlX2RhdGEiLCJwcm9kdWN0X2RhdGEiLCJpbWFnZXMiLCJpbWFnZSIsIm1ldGFkYXRhIiwidW5pdF9hbW91bnQiLCJ2YWxpZGF0ZUNhcnRGb3JDaGVja291dCIsImNhcnRWYWxpZGF0aW9uIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/cart.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/stripe.ts":
/*!***************************!*\
  !*** ./src/lib/stripe.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   getStripe: () => (/* binding */ getStripe),\n/* harmony export */   getStripeConfig: () => (/* binding */ getStripeConfig),\n/* harmony export */   getStripeServer: () => (/* binding */ getStripeServer),\n/* harmony export */   testStripeConnection: () => (/* binding */ testStripeConnection)\n/* harmony export */ });\n/* harmony import */ var _stripe_stripe_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @stripe/stripe-js */ \"(rsc)/./node_modules/@stripe/stripe-js/lib/index.mjs\");\n/* harmony import */ var stripe__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! stripe */ \"(rsc)/./node_modules/stripe/esm/stripe.esm.node.js\");\n\n\n// Environment validation\nconst validateEnvironment = ()=>{\n    const publishableKey = \"pk_test_51R9pLT2KYi1EVCMzHc8vDqSNTMpgfL5kMzX4qP68gdQp53ioubKm4dquVENb7YByxZ06bxOJhjzdnVLD2vo5wBbh00O0ngluNA\";\n    const secretKey = process.env.STRIPE_SECRET_KEY;\n    if (true) {\n        // Server-side validation\n        if (!secretKey) {\n            throw new Error(\"STRIPE_SECRET_KEY is required but not set in environment variables\");\n        }\n        if (!secretKey.startsWith(\"sk_\")) {\n            throw new Error('STRIPE_SECRET_KEY must start with \"sk_\"');\n        }\n    }\n    // Client-side validation\n    if (!publishableKey) {\n        throw new Error(\"NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY is required but not set in environment variables\");\n    }\n    if (!publishableKey.startsWith(\"pk_\")) {\n        throw new Error('NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY must start with \"pk_\"');\n    }\n    // Environment consistency check\n    const isTestMode = publishableKey.includes(\"test\");\n    const isSecretTestMode = secretKey?.includes(\"test\") ?? true;\n    if (isTestMode !== isSecretTestMode) {\n        console.warn(\"Warning: Stripe keys environment mismatch (test vs live)\");\n    }\n    return {\n        publishableKey,\n        secretKey,\n        isTestMode\n    };\n};\n// Client-side Stripe instance\nlet stripePromise;\nconst getStripe = ()=>{\n    if (!stripePromise) {\n        const { publishableKey } = validateEnvironment();\n        stripePromise = (0,_stripe_stripe_js__WEBPACK_IMPORTED_MODULE_0__.loadStripe)(publishableKey);\n    }\n    return stripePromise;\n};\n// Server-side Stripe instance\nlet stripeServer = null;\nconst getStripeServer = ()=>{\n    if (!stripeServer) {\n        const { secretKey } = validateEnvironment();\n        if (!secretKey) {\n            throw new Error(\"Cannot initialize server-side Stripe without STRIPE_SECRET_KEY\");\n        }\n        stripeServer = new stripe__WEBPACK_IMPORTED_MODULE_1__[\"default\"](secretKey, {\n            apiVersion: \"2024-06-20\",\n            typescript: true\n        });\n    }\n    return stripeServer;\n};\n// Configuration utilities\nconst getStripeConfig = ()=>{\n    const { publishableKey, secretKey, isTestMode } = validateEnvironment();\n    return {\n        publishableKey,\n        secretKey: secretKey ? \"***\" + secretKey.slice(-4) : undefined,\n        isTestMode,\n        environment: \"development\",\n        apiVersion: \"2024-06-20\"\n    };\n};\n// Test connection utility\nconst testStripeConnection = async ()=>{\n    try {\n        if (false) {} else {\n            // Server-side test\n            const stripe = getStripeServer();\n            await stripe.customers.list({\n                limit: 1\n            });\n            return true;\n        }\n    } catch (error) {\n        console.error(\"Stripe connection test failed:\", error);\n        return false;\n    }\n};\n// Legacy export for backward compatibility\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (getStripe);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N0cmlwZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQXNEO0FBQ3JCO0FBRWpDLHlCQUF5QjtBQUN6QixNQUFNRSxzQkFBc0I7SUFDMUIsTUFBTUMsaUJBQWlCQyw2R0FBOEM7SUFDckUsTUFBTUcsWUFBWUgsUUFBUUMsR0FBRyxDQUFDRyxpQkFBaUI7SUFFL0MsSUFBSSxJQUFrQixFQUFhO1FBQ2pDLHlCQUF5QjtRQUN6QixJQUFJLENBQUNELFdBQVc7WUFDZCxNQUFNLElBQUlFLE1BQU07UUFDbEI7UUFDQSxJQUFJLENBQUNGLFVBQVVHLFVBQVUsQ0FBQyxRQUFRO1lBQ2hDLE1BQU0sSUFBSUQsTUFBTTtRQUNsQjtJQUNGO0lBRUEseUJBQXlCO0lBQ3pCLElBQUksQ0FBQ04sZ0JBQWdCO1FBQ25CLE1BQU0sSUFBSU0sTUFBTTtJQUNsQjtJQUNBLElBQUksQ0FBQ04sZUFBZU8sVUFBVSxDQUFDLFFBQVE7UUFDckMsTUFBTSxJQUFJRCxNQUFNO0lBQ2xCO0lBRUEsZ0NBQWdDO0lBQ2hDLE1BQU1FLGFBQWFSLGVBQWVTLFFBQVEsQ0FBQztJQUMzQyxNQUFNQyxtQkFBbUJOLFdBQVdLLFNBQVMsV0FBVztJQUV4RCxJQUFJRCxlQUFlRSxrQkFBa0I7UUFDbkNDLFFBQVFDLElBQUksQ0FBQztJQUNmO0lBRUEsT0FBTztRQUNMWjtRQUNBSTtRQUNBSTtJQUNGO0FBQ0Y7QUFFQSw4QkFBOEI7QUFDOUIsSUFBSUs7QUFFRyxNQUFNQyxZQUFZO0lBQ3ZCLElBQUksQ0FBQ0QsZUFBZTtRQUNsQixNQUFNLEVBQUViLGNBQWMsRUFBRSxHQUFHRDtRQUMzQmMsZ0JBQWdCaEIsNkRBQVVBLENBQUNHO0lBQzdCO0lBQ0EsT0FBT2E7QUFDVCxFQUFDO0FBRUQsOEJBQThCO0FBQzlCLElBQUlFLGVBQW9DO0FBRWpDLE1BQU1DLGtCQUFrQjtJQUM3QixJQUFJLENBQUNELGNBQWM7UUFDakIsTUFBTSxFQUFFWCxTQUFTLEVBQUUsR0FBR0w7UUFFdEIsSUFBSSxDQUFDSyxXQUFXO1lBQ2QsTUFBTSxJQUFJRSxNQUFNO1FBQ2xCO1FBRUFTLGVBQWUsSUFBSWpCLDhDQUFZQSxDQUFDTSxXQUFXO1lBQ3pDYSxZQUFZO1lBQ1pDLFlBQVk7UUFDZDtJQUNGO0lBRUEsT0FBT0g7QUFDVCxFQUFDO0FBRUQsMEJBQTBCO0FBQ25CLE1BQU1JLGtCQUFrQjtJQUM3QixNQUFNLEVBQUVuQixjQUFjLEVBQUVJLFNBQVMsRUFBRUksVUFBVSxFQUFFLEdBQUdUO0lBRWxELE9BQU87UUFDTEM7UUFDQUksV0FBV0EsWUFBWSxRQUFRQSxVQUFVZ0IsS0FBSyxDQUFDLENBQUMsS0FBS0M7UUFDckRiO1FBQ0FjLGFBaEZKO1FBaUZJTCxZQUFZO0lBQ2Q7QUFDRixFQUFDO0FBRUQsMEJBQTBCO0FBQ25CLE1BQU1NLHVCQUF1QjtJQUNsQyxJQUFJO1FBQ0YsSUFBSSxLQUFrQixFQUFhLEVBSWxDLE1BQU07WUFDTCxtQkFBbUI7WUFDbkIsTUFBTUMsU0FBU1I7WUFDZixNQUFNUSxPQUFPQyxTQUFTLENBQUNDLElBQUksQ0FBQztnQkFBRUMsT0FBTztZQUFFO1lBQ3ZDLE9BQU87UUFDVDtJQUNGLEVBQUUsT0FBT0MsT0FBTztRQUNkakIsUUFBUWlCLEtBQUssQ0FBQyxrQ0FBa0NBO1FBQ2hELE9BQU87SUFDVDtBQUNGLEVBQUM7QUFFRCwyQ0FBMkM7QUFDM0MsaUVBQWVkLFNBQVNBLEVBQUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9teS10ZWNoLWdsYXNzZXMvLi9zcmMvbGliL3N0cmlwZS50cz83OThhIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGxvYWRTdHJpcGUsIFN0cmlwZSB9IGZyb20gJ0BzdHJpcGUvc3RyaXBlLWpzJ1xuaW1wb3J0IFN0cmlwZVNlcnZlciBmcm9tICdzdHJpcGUnXG5cbi8vIEVudmlyb25tZW50IHZhbGlkYXRpb25cbmNvbnN0IHZhbGlkYXRlRW52aXJvbm1lbnQgPSAoKSA9PiB7XG4gIGNvbnN0IHB1Ymxpc2hhYmxlS2V5ID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1RSSVBFX1BVQkxJU0hBQkxFX0tFWVxuICBjb25zdCBzZWNyZXRLZXkgPSBwcm9jZXNzLmVudi5TVFJJUEVfU0VDUkVUX0tFWVxuXG4gIGlmICh0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJykge1xuICAgIC8vIFNlcnZlci1zaWRlIHZhbGlkYXRpb25cbiAgICBpZiAoIXNlY3JldEtleSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdTVFJJUEVfU0VDUkVUX0tFWSBpcyByZXF1aXJlZCBidXQgbm90IHNldCBpbiBlbnZpcm9ubWVudCB2YXJpYWJsZXMnKVxuICAgIH1cbiAgICBpZiAoIXNlY3JldEtleS5zdGFydHNXaXRoKCdza18nKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdTVFJJUEVfU0VDUkVUX0tFWSBtdXN0IHN0YXJ0IHdpdGggXCJza19cIicpXG4gICAgfVxuICB9XG5cbiAgLy8gQ2xpZW50LXNpZGUgdmFsaWRhdGlvblxuICBpZiAoIXB1Ymxpc2hhYmxlS2V5KSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdORVhUX1BVQkxJQ19TVFJJUEVfUFVCTElTSEFCTEVfS0VZIGlzIHJlcXVpcmVkIGJ1dCBub3Qgc2V0IGluIGVudmlyb25tZW50IHZhcmlhYmxlcycpXG4gIH1cbiAgaWYgKCFwdWJsaXNoYWJsZUtleS5zdGFydHNXaXRoKCdwa18nKSkge1xuICAgIHRocm93IG5ldyBFcnJvcignTkVYVF9QVUJMSUNfU1RSSVBFX1BVQkxJU0hBQkxFX0tFWSBtdXN0IHN0YXJ0IHdpdGggXCJwa19cIicpXG4gIH1cblxuICAvLyBFbnZpcm9ubWVudCBjb25zaXN0ZW5jeSBjaGVja1xuICBjb25zdCBpc1Rlc3RNb2RlID0gcHVibGlzaGFibGVLZXkuaW5jbHVkZXMoJ3Rlc3QnKVxuICBjb25zdCBpc1NlY3JldFRlc3RNb2RlID0gc2VjcmV0S2V5Py5pbmNsdWRlcygndGVzdCcpID8/IHRydWVcblxuICBpZiAoaXNUZXN0TW9kZSAhPT0gaXNTZWNyZXRUZXN0TW9kZSkge1xuICAgIGNvbnNvbGUud2FybignV2FybmluZzogU3RyaXBlIGtleXMgZW52aXJvbm1lbnQgbWlzbWF0Y2ggKHRlc3QgdnMgbGl2ZSknKVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICBwdWJsaXNoYWJsZUtleSxcbiAgICBzZWNyZXRLZXksXG4gICAgaXNUZXN0TW9kZVxuICB9XG59XG5cbi8vIENsaWVudC1zaWRlIFN0cmlwZSBpbnN0YW5jZVxubGV0IHN0cmlwZVByb21pc2U6IFByb21pc2U8U3RyaXBlIHwgbnVsbD5cblxuZXhwb3J0IGNvbnN0IGdldFN0cmlwZSA9ICgpOiBQcm9taXNlPFN0cmlwZSB8IG51bGw+ID0+IHtcbiAgaWYgKCFzdHJpcGVQcm9taXNlKSB7XG4gICAgY29uc3QgeyBwdWJsaXNoYWJsZUtleSB9ID0gdmFsaWRhdGVFbnZpcm9ubWVudCgpXG4gICAgc3RyaXBlUHJvbWlzZSA9IGxvYWRTdHJpcGUocHVibGlzaGFibGVLZXkpXG4gIH1cbiAgcmV0dXJuIHN0cmlwZVByb21pc2Vcbn1cblxuLy8gU2VydmVyLXNpZGUgU3RyaXBlIGluc3RhbmNlXG5sZXQgc3RyaXBlU2VydmVyOiBTdHJpcGVTZXJ2ZXIgfCBudWxsID0gbnVsbFxuXG5leHBvcnQgY29uc3QgZ2V0U3RyaXBlU2VydmVyID0gKCk6IFN0cmlwZVNlcnZlciA9PiB7XG4gIGlmICghc3RyaXBlU2VydmVyKSB7XG4gICAgY29uc3QgeyBzZWNyZXRLZXkgfSA9IHZhbGlkYXRlRW52aXJvbm1lbnQoKVxuICAgIFxuICAgIGlmICghc2VjcmV0S2V5KSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCBpbml0aWFsaXplIHNlcnZlci1zaWRlIFN0cmlwZSB3aXRob3V0IFNUUklQRV9TRUNSRVRfS0VZJylcbiAgICB9XG5cbiAgICBzdHJpcGVTZXJ2ZXIgPSBuZXcgU3RyaXBlU2VydmVyKHNlY3JldEtleSwge1xuICAgICAgYXBpVmVyc2lvbjogJzIwMjQtMDYtMjAnLFxuICAgICAgdHlwZXNjcmlwdDogdHJ1ZSxcbiAgICB9KVxuICB9XG4gIFxuICByZXR1cm4gc3RyaXBlU2VydmVyXG59XG5cbi8vIENvbmZpZ3VyYXRpb24gdXRpbGl0aWVzXG5leHBvcnQgY29uc3QgZ2V0U3RyaXBlQ29uZmlnID0gKCkgPT4ge1xuICBjb25zdCB7IHB1Ymxpc2hhYmxlS2V5LCBzZWNyZXRLZXksIGlzVGVzdE1vZGUgfSA9IHZhbGlkYXRlRW52aXJvbm1lbnQoKVxuICBcbiAgcmV0dXJuIHtcbiAgICBwdWJsaXNoYWJsZUtleSxcbiAgICBzZWNyZXRLZXk6IHNlY3JldEtleSA/ICcqKionICsgc2VjcmV0S2V5LnNsaWNlKC00KSA6IHVuZGVmaW5lZCwgLy8gTWFza2VkIGZvciBsb2dnaW5nXG4gICAgaXNUZXN0TW9kZSxcbiAgICBlbnZpcm9ubWVudDogcHJvY2Vzcy5lbnYuTk9ERV9FTlYsXG4gICAgYXBpVmVyc2lvbjogJzIwMjQtMDYtMjAnIGFzIGNvbnN0XG4gIH1cbn1cblxuLy8gVGVzdCBjb25uZWN0aW9uIHV0aWxpdHlcbmV4cG9ydCBjb25zdCB0ZXN0U3RyaXBlQ29ubmVjdGlvbiA9IGFzeW5jICgpOiBQcm9taXNlPGJvb2xlYW4+ID0+IHtcbiAgdHJ5IHtcbiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIC8vIENsaWVudC1zaWRlIHRlc3RcbiAgICAgIGNvbnN0IHN0cmlwZSA9IGF3YWl0IGdldFN0cmlwZSgpXG4gICAgICByZXR1cm4gc3RyaXBlICE9PSBudWxsXG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIFNlcnZlci1zaWRlIHRlc3RcbiAgICAgIGNvbnN0IHN0cmlwZSA9IGdldFN0cmlwZVNlcnZlcigpXG4gICAgICBhd2FpdCBzdHJpcGUuY3VzdG9tZXJzLmxpc3QoeyBsaW1pdDogMSB9KVxuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignU3RyaXBlIGNvbm5lY3Rpb24gdGVzdCBmYWlsZWQ6JywgZXJyb3IpXG4gICAgcmV0dXJuIGZhbHNlXG4gIH1cbn1cblxuLy8gTGVnYWN5IGV4cG9ydCBmb3IgYmFja3dhcmQgY29tcGF0aWJpbGl0eVxuZXhwb3J0IGRlZmF1bHQgZ2V0U3RyaXBlIl0sIm5hbWVzIjpbImxvYWRTdHJpcGUiLCJTdHJpcGVTZXJ2ZXIiLCJ2YWxpZGF0ZUVudmlyb25tZW50IiwicHVibGlzaGFibGVLZXkiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1RSSVBFX1BVQkxJU0hBQkxFX0tFWSIsInNlY3JldEtleSIsIlNUUklQRV9TRUNSRVRfS0VZIiwiRXJyb3IiLCJzdGFydHNXaXRoIiwiaXNUZXN0TW9kZSIsImluY2x1ZGVzIiwiaXNTZWNyZXRUZXN0TW9kZSIsImNvbnNvbGUiLCJ3YXJuIiwic3RyaXBlUHJvbWlzZSIsImdldFN0cmlwZSIsInN0cmlwZVNlcnZlciIsImdldFN0cmlwZVNlcnZlciIsImFwaVZlcnNpb24iLCJ0eXBlc2NyaXB0IiwiZ2V0U3RyaXBlQ29uZmlnIiwic2xpY2UiLCJ1bmRlZmluZWQiLCJlbnZpcm9ubWVudCIsInRlc3RTdHJpcGVDb25uZWN0aW9uIiwic3RyaXBlIiwiY3VzdG9tZXJzIiwibGlzdCIsImxpbWl0IiwiZXJyb3IiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/stripe.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/stripe","vendor-chunks/qs","vendor-chunks/object-inspect","vendor-chunks/get-intrinsic","vendor-chunks/@stripe","vendor-chunks/side-channel-list","vendor-chunks/side-channel-weakmap","vendor-chunks/has-symbols","vendor-chunks/function-bind","vendor-chunks/side-channel-map","vendor-chunks/side-channel","vendor-chunks/get-proto","vendor-chunks/call-bind-apply-helpers","vendor-chunks/dunder-proto","vendor-chunks/math-intrinsics","vendor-chunks/call-bound","vendor-chunks/es-errors","vendor-chunks/gopd","vendor-chunks/es-define-property","vendor-chunks/hasown","vendor-chunks/es-object-atoms"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fcreate-checkout-session%2Froute&page=%2Fapi%2Fcreate-checkout-session%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fcreate-checkout-session%2Froute.ts&appDir=%2FUsers%2Ftomaszgt%2FMytechglasses%2Fmy-tech-glasses%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Ftomaszgt%2FMytechglasses%2Fmy-tech-glasses&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();